[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Atelier du la sph√®re sondage sur l‚Äôestimation de variance",
    "section": "",
    "text": "Calendrier\nDes coquilles peuvent √™tre cach√©es dans les documents : n‚Äôh√©sitez pas √† le notifier par mail ou faire un pull-request.\n\n\n\nDate\nHeure\nSujet\nLien\nD√©finitifs ?\nCompl√©ments / Corrections\n\n\n\n\n20 juin 2024\n13:00 - 15:00\nPr√©sentation du calcul de variance analytique\n\n‚ùå\n\n\n\n20 juin 2024\n13:00 - 15:00\nApplication avec gustave\n\n‚ùå\n\n\n\n2 juillet 2024\n13:00 - 15:00\nPr√©sentation du calcul de variance par bootstrap\n\n‚ùå\n\n\n\n\n\n\nEnregistrement au format pdf\nLes pr√©sentations sont disponibles au format html. Cependant, ce format n‚Äôest pas le plus optimis√© pour l‚Äôannotation. Il est possible d‚Äôenregistrer au format pdf en :\n\nutilisant Google Chrome ou un autre navigateur,\nappuyant sur la touche e de votre clavier lorsque vous √™tes sur la pr√©sentation,\nappuyant sur la combinaison CTRL + P et en enregistrant au format pdf.\n\n\n\n\nTransformation de html vers pdf"
  },
  {
    "objectID": "presentations/pres_analytique.html#pourquoi",
    "href": "presentations/pres_analytique.html#pourquoi",
    "title": "Atelier du r√©seau sondage",
    "section": "Pourquoi ?",
    "text": "Pourquoi ?\n\nLa variance permet de quantifier la variabilit√© d‚Äôun estimateur.\nCertaines enqu√™tes de l‚ÄôInsee sont soumises √† un cadre r√©glementaire europ√©en, qui leur impose entre autres des niveaux de pr√©cision cibles pour quelques indicateurs.\nLe calcul de pr√©cision tend, de fait, √† prendre une part de plus en plus importante dans la production de statistiques publiques.\nTout calcul de pr√©cision doit prendre en compte diff√©rents √©l√©ments :\n\nLe plan de sondage retenu.\nLe choix de l‚Äôestimateur initial.\nLes diff√©rentes √©tapes de redressements : correction de la non-r√©ponse, partage des poids, calage ‚Ä¶"
  },
  {
    "objectID": "presentations/pres_analytique.html#int√©r√™t-des-calculs-de-variance",
    "href": "presentations/pres_analytique.html#int√©r√™t-des-calculs-de-variance",
    "title": "Atelier du r√©seau sondage",
    "section": "Int√©r√™t des calculs de variance",
    "text": "Int√©r√™t des calculs de variance\n\n\nPour le charg√© d‚Äô√©tudes :\n\nPermet la construction d‚Äôun intervalle de confiance\nPermet de commenter la significativit√© des variations d‚Äôun indicateur\n\n\n\n\n\nL‚Äôestimation de variance permet de mesurer la qualit√© des indicateurs produits :\n\nUtilis√©e pour les rapports qualit√© transmis √† Eurostat\nRequise pour divers indicateurs dans diff√©rentes enqu√™tes par le r√®glement IESS\n\n\n\n\n\nL‚Äôestimation de variance gagne en importance dans le processus de production des enqu√™tes"
  },
  {
    "objectID": "presentations/pres_analytique.html#le-r√®glement-cadre-iess",
    "href": "presentations/pres_analytique.html#le-r√®glement-cadre-iess",
    "title": "Atelier du r√©seau sondage",
    "section": "Le r√®glement cadre IESS",
    "text": "Le r√®glement cadre IESS\n\n\nLe r√®glement-cadre IESS (Integrated European Social Statistics) a √©t√© adopt√© en avril 2019.\nIl vise √† imposer un cadre europ√©en harmonis√© afin de garantir la comparabilit√© des indicateurs entre pays des √âtats membres.\nL‚ÄôInsee a mis en place un programme de r√©novation progressive de ses enqu√™tes sociales, avec une part grandissante sous r√®glement europ√©en.\n\n\n\n\nContraintes sur les √©carts-types d‚Äôestimateurs nationaux et r√©gionaux (au niveau des NUTS 2 : anciennes r√©gions pour la France).\n\nLes estimateurs concern√©s sont toujours des taux.\nLes contraintes de pr√©cision d√©pendent des tailles de population : contraintes moins strictes pour les petites r√©gions (points 6 et 7 de l‚Äôannexe II).\n\n\n\n\n\nHormis pour quelques exceptions, l‚Äô√©cart-type estim√© des estimateurs ne doit pas exc√©der \\(\\sqrt{\\frac{\\widehat{p}(1-\\widehat{p})}{a\\sqrt{N}+b}}\\) o√π \\(\\widehat{p}\\) est l‚Äôestimateur consid√©r√©, \\(a\\) et \\(b\\) sont des param√®tres fix√©s par IESS et \\(N\\) est un nombre d‚Äôindividus ou de m√©nages li√©s √† l‚Äôindicateur.\n\n\n\n\nLes contraintes de pr√©cision r√©gionales sont plus contraignantes pour les r√©gions plus peupl√©es."
  },
  {
    "objectID": "presentations/pres_analytique.html#le-r√®glement-fribs",
    "href": "presentations/pres_analytique.html#le-r√®glement-fribs",
    "title": "Atelier du r√©seau sondage",
    "section": "Le r√®glement FRIBS",
    "text": "Le r√®glement FRIBS\n\nIl existe √©galement un r√®glement-cadre europ√©en sur les statistiques d‚Äôentreprises, nomm√© FRIBS (Framework Regulation Integrating Business Statistics) et adopt√© en 2019.\nFRIBS remplace dix r√®glements sectoriels en vigueur jusqu‚Äôen 2021.\nIl cr√©e un cadre juridique commun pour les statistiques d‚Äôentreprises, r√©duisant les incoh√©rences entre domaines et les redondances, sans les supprimer totalement.\nFRIBS s‚Äôapplique pour l‚Äôessentiel √† partir de l‚Äôann√©e de r√©f√©rence 2021."
  },
  {
    "objectID": "presentations/pres_analytique.html#d√©finitions-usuelles-et-notations.",
    "href": "presentations/pres_analytique.html#d√©finitions-usuelles-et-notations.",
    "title": "Atelier du r√©seau sondage",
    "section": "D√©finitions usuelles et notations.",
    "text": "D√©finitions usuelles et notations.\n\nDans cette pr√©sentation, on notera :\n\n\\(\\mathcal{U}\\), une population finie de taille \\(N\\),\n\\(p\\), un plan de sondage d√©fini sur \\(\\mathcal{U}\\),\n\\(S\\) un √©chantillon al√©atoire tir√© selon le plan \\(p\\).\n\n\n\n\n\\(\\{y_k\\}\\) : une variable d‚Äôint√©r√™t,\n\\(\\{x_k\\}\\) : une variable auxiliaire.\n\n\n\nPour l‚Äôinf√©rence, il est commode d‚Äôintroduire :\n\nPour tout individu \\(k \\in \\mathcal{U}, ~ \\pi_k = \\mathbb{P}(k \\in S)\\) \\(\\to\\) probabilit√© d‚Äôinclusion d‚Äôordre 1.\n\nIl s‚Äôagit de la probabilit√© que l‚Äôindividu \\(k\\) soit dans l‚Äô√©chantillon \\(S\\).\n\nPour tout couple d‚Äôindividus \\((k,l) \\in \\mathcal{U}^2, ~ \\pi_{kl} = \\mathbb{P}(k \\in S \\cap l \\in S)\\) \\(\\to\\) probabilit√© d‚Äôinclusion d‚Äôordre 2.\n\nIl s‚Äôagit de la probabilit√© que les individus \\(k\\) et \\(l\\) soient conjointement dans l‚Äô√©chantillon \\(S\\)."
  },
  {
    "objectID": "presentations/pres_analytique.html#estimateur-dhorvitz-thompson",
    "href": "presentations/pres_analytique.html#estimateur-dhorvitz-thompson",
    "title": "Atelier du r√©seau sondage",
    "section": "Estimateur d‚ÄôHorvitz-Thompson",
    "text": "Estimateur d‚ÄôHorvitz-Thompson\n\n\nComment estimer le total \\(\\displaystyle t_y = \\sum_{k \\in \\mathcal{U}} y_k\\) en utilisant l‚Äôinformation disponible uniquement sur l‚Äô√©chantillon \\(S\\) ?\n\nL‚Äôestimateur \\(\\displaystyle \\hat{t}_{y,\\text{HT}} = \\sum_{k \\in S} \\frac{y_k}{\\pi_k}\\) est appel√© estimateur d‚ÄôHovitz-Thompson du total.\n\n\n\n\n\nEst-ce un bon estimateur ?\n\n\n\n\nCrit√®re de biais et de variance.\n\n\n\n\n\n\n\n\nMise en garde\n\n\n\nD√©finition 1 (Biais d‚Äôun estimateur) Le biais d‚Äôun estimateur \\(\\hat{\\theta}\\) d‚Äôune fonction d‚Äôint√©r√™t \\(\\theta\\) est donn√© par \\(\\mathbb{B}(\\hat{\\theta}; \\theta) = \\mathbb{E}(\\hat{\\theta}) - \\theta\\).\n\n\n\n\n\n\n\n\n\n\nMise en garde\n\n\n\nD√©finition 2 (Variance) La variance d‚Äôun estimateur \\(\\hat \\theta\\) d‚Äôune fonction d‚Äôint√©r√™t \\(\\theta\\) est donn√© par \\(\\mathbb{V}(\\hat \\theta) = \\mathbb{E}(\\left(\\hat \\theta  - \\mathbb{E}(\\hat \\theta) \\right)^2)\\).\nLa variance permet de quantifier la variabilit√© d‚Äôun estimateur."
  },
  {
    "objectID": "presentations/pres_analytique.html#arbitrage-biaisvariance",
    "href": "presentations/pres_analytique.html#arbitrage-biaisvariance",
    "title": "Atelier du r√©seau sondage",
    "section": "Arbitrage biais/variance",
    "text": "Arbitrage biais/variance"
  },
  {
    "objectID": "presentations/pres_analytique.html#estimateur-dhorvitz-thompson-biais-et-variance",
    "href": "presentations/pres_analytique.html#estimateur-dhorvitz-thompson-biais-et-variance",
    "title": "Atelier du r√©seau sondage",
    "section": "Estimateur d‚ÄôHorvitz-Thompson : biais et variance",
    "text": "Estimateur d‚ÄôHorvitz-Thompson : biais et variance\n\n\nSi pour tout \\(k \\in \\mathcal{U},~~ \\pi_k &gt; 0\\) alors \\(\\hat{t}_{y,\\text{HT}}\\) est un estimateur sans biais de \\(t_y\\).\n\n\n\n\nS‚Äôil existe un individu \\(j\\) tel que \\(\\pi_j = 0\\), alors il y a un d√©faut de couverture \\(\\to\\) biais.\n\n\n\n\nQuid de la variance de \\(\\hat{t}_{y,\\text{HT}}\\) ?\n\n\\[\\mathbb{V}(\\hat t_{y,\\text{HT}}) = \\sum_{k \\in \\color{red}{\\mathcal{U}}} \\sum_{l \\in \\color{red}{\\mathcal{U}}} \\frac{y_k}{\\pi_k} \\frac{y_l}{\\pi_l} \\Delta_{kl}\\] o√π \\(\\Delta_{kl} = \\pi_{kl} - \\pi_k \\pi_l\\)\nProbl√®me : la variance est fonction des valeurs de \\(\\{y_k\\}\\) sur \\(\\color{red}{\\mathcal{U}}\\) mais cette information n‚Äôest disponible que sur \\(\\mathcal{S}\\).\nSolution : estimer la variance.\n\n\n\n\n\n\n\n\n\nEstimateur de variance d‚ÄôHorvitz-Thompson\n\n\n\\[\\hat{\\mathbb{V}}_\\text{HT}(\\hat t_{y,\\text{HT}}) = \\sum_{k \\in \\mathcal{U}} \\sum_{k \\in \\mathcal{U}} \\frac{y_k}{\\pi_k} \\frac{y_l}{\\pi_l} \\Delta_{kl} \\color{red}{\\frac{I_{kl}}{\\pi_{kl}}} \\color{black} = \\sum_{k \\in S} \\sum_{l \\in S} \\frac{y_k}{\\pi_k} \\frac{y_l}{\\pi_l} {\\frac{\\Delta_{kl}}{\\pi_{kl}}} \\]\nPropri√©t√©s :\n\nSi pour tout \\((k,l) \\in \\mathcal{U}^2\\), \\(\\pi_{kl} &gt; 0\\), \\(\\hat{\\mathbb{V}}_\\text{HT}(\\hat t_{y,\\text{HT}})\\) est sans biais pour \\(\\mathbb{V}(\\hat t_{y,\\text{HT}})\\)\n\n\n\n\n\n\n\n\n\n\nEstimateur de Sen-Yates-Grundy\n\n\n\\[\\hat{\\mathbb{V}}_\\text{SYG}(\\hat t_{y,\\text{HT}}) =  - \\frac{1}{2} \\sum_{k \\in \\mathcal{S}} \\sum_{l \\in \\mathcal{S} | k \\neq l} \\left(\\frac{y_k}{\\pi_k} - \\frac{y_l}{\\pi_l} \\right)^2 \\frac{\\Delta_{kl}}{\\pi_{kl}}\\]\nPropri√©t√©s :\n\nSi pour tout \\((k,l) \\in \\mathcal{U}^2\\), \\(\\pi_{kl} &gt; 0\\) et le plan \\(p\\) est de taille fixe alors \\(\\hat{\\mathbb{V}}_\\text{SYG}(\\hat t_{y,\\text{HT}})\\) est sans biais pour \\(\\mathbb{V}(\\hat t_{y,\\text{HT}})\\).\nSi pour tout \\((k,l) \\in \\mathcal{U}^2\\), \\(\\pi_{kl} - \\pi_k \\pi_l \\leq 0\\) alors \\(\\hat{\\mathbb{V}}_\\text{SYG}(\\hat t_{y,\\text{HT}}) \\geq 0\\)."
  },
  {
    "objectID": "presentations/pres_analytique.html#sec-tclsondage",
    "href": "presentations/pres_analytique.html#sec-tclsondage",
    "title": "Atelier du r√©seau sondage",
    "section": "Th√©or√®me central limite en sondage",
    "text": "Th√©or√®me central limite en sondage\n\n\nRappel sur le th√©or√®me central limite dans le cas i.i.d : Rappel\nEst-ce que le th√©or√®me central limite est applicable en sondage sur l‚Äôestimateur d‚ÄôHorvitz-Thompson ?\nPar exemple : \\[\\frac{1}{\\mathbb{V}^{\\frac{1}{2}}(\\hat t_{y,\\text{HT}})}(\\hat t_{y,\\text{HT}} - t_y) \\hookrightarrow \\mathcal{N}(0,1) \\] o√π \\(\\hookrightarrow\\) d√©signe la convergence en loi\n\n\n\n\nUn th√©or√®me central limite pour les gouverner tous : ‚ùå\n\nH√°jek (1960) : pour le SRS.\nBerger (1998) : pour les plans √† forte entropie.\nChauvet (2015) : pour les sondages √† plusieurs degr√©s avec un \\(\\text{SASSR}\\) au premier degr√©. ‚Ä¶\n\nChamp de recherche ouvert : th√©orie unifi√©e ? D‚Äôautres TCL ?"
  },
  {
    "objectID": "presentations/pres_analytique.html#th√©or√®me-central-limite-en-sondage",
    "href": "presentations/pres_analytique.html#th√©or√®me-central-limite-en-sondage",
    "title": "Atelier du r√©seau sondage",
    "section": "Th√©or√®me central limite en sondage",
    "text": "Th√©or√®me central limite en sondage\n\n\nEn g√©n√©ral, on supposera toujours que le th√©or√®me central limite tient : \\[\\frac{1}{\\mathbb{V}^{\\frac{1}{2}}(\\hat t_{y,\\text{HT}})}(\\hat t_{y,\\text{HT}} - t_y) \\hookrightarrow \\mathcal{N}(0,1) \\]\n\n\n\n\nUn intervalle de confiance asymptotique au niveau \\(1-\\alpha\\) est donn√© par : \\[ [ \\hat t_{y,\\text{HT}} - q_{1 - \\frac{\\alpha}{2}} \\color{red}{\\mathbb{V}}^{\\frac{1}{2}}(\\hat t_{y,\\text{HT}}), \\hat t_{y,\\text{HT}} + q_{1 - \\frac{\\alpha}{2}} \\color{red}{\\mathbb{V}}^{\\frac{1}{2}}(\\hat t_{y,\\text{HT}})  ] \\] avec \\(q_{1 - \\frac{\\alpha}{2}}\\), le quantile d‚Äôordre \\(1- \\frac{\\alpha}{2}\\) de la loi normale centr√©e r√©duite\n\n\n\n\nProbl√®me : \\(\\mathbb{V}(\\hat t_{y,\\text{HT}})\\) pas connu mais ‚Ä¶ on peut utiliser un estimateur consistant de \\(\\hat{\\mathbb{V}}(\\hat t_{y,\\text{HT}})\\).\n\n\n\n\n\n\nLemme de Slustky\n\n\nSi \\((X_n,Y_n)_{n \\in \\mathbb{N}}\\) tel que \\(X_n \\to^{\\mathbb{P}} c\\) (une constante) et \\(Y_n  \\hookrightarrow Y\\) alors \\((X_n, Y_n) \\hookrightarrow (X,Y)\\).\n\n\n\n\n\n\\(\\to\\) Remplacement de \\(\\mathbb{V}(\\hat t_{y,\\text{HT}})\\) par un estimateur \\(\\hat{\\mathbb{V}}_\\text{HT}(\\hat t_{y,\\text{HT}})\\) ou \\(\\hat{\\mathbb{V}}_\\text{SYG}(\\hat t_{y,\\text{HT}})\\) (si taille fixe)."
  },
  {
    "objectID": "presentations/pres_analytique.html#application-au-plan-al√©atoire-simple-sans-remise",
    "href": "presentations/pres_analytique.html#application-au-plan-al√©atoire-simple-sans-remise",
    "title": "Atelier du r√©seau sondage",
    "section": "Application au plan al√©atoire simple sans remise",
    "text": "Application au plan al√©atoire simple sans remise\n\n\n\nPlan al√©atoire simple sans remise\n\n\n\\(p_{\\text{SASSR}(n;N)}\\) est un plan al√©atoire simple sans remise de taille \\(n\\) parmi \\(N\\) si :\n\nTous les √©chantillons de taille \\(n\\) ont la m√™me probabilit√© d‚Äô√™tre tir√©,\nSi tous les √©chantillons de taille diff√©rente de \\(n\\) ont une probabilit√© nulle d‚Äô√™tre tir√©.\n\nSi \\(S \\sim p_{\\text{SASSR}(n;N)}\\) alors pour tout \\((k,l) \\in \\mathcal{U}^2, ~~ \\pi_k = \\frac{n}{N}\\) et si \\(k \\neq l~~\\), \\(\\pi_{kl} = \\frac{n(n-1)}{N(N-1)}\\)\nApplication : \\(\\hat{\\mathbb{V}}_\\text{SYG}(\\hat t_{y,\\text{HT}}) = \\hat{\\mathbb{V}}_\\text{HT}(\\hat t_{y,\\text{HT}}) = \\frac{N^2}{n} (1 - \\frac{n}{N}) s^2_y\\) o√π \\(s^2_y\\) est la dispersion de la variable \\(\\{y_k\\}\\) sur l‚Äô√©chantillon \\(S\\).\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "presentations/pres_analytique.html#application-au-plan-poissonien",
    "href": "presentations/pres_analytique.html#application-au-plan-poissonien",
    "title": "Atelier du r√©seau sondage",
    "section": "Application au plan poissonien",
    "text": "Application au plan poissonien\n\n\n\nPlan poissonien\n\n\n\\(p_{\\text{Poisson}(\\textbf{p})}\\) o√π \\(\\textbf{p} = (p_1, ..., p_N) \\in [0;1]^N\\) est un plan de Poisson si :\n\nTous les individus sont tir√©s ind√©pendamment les uns des autres,\nLa probabilit√© d‚Äôun individu \\(k\\) soit dans l‚Äô√©chantillon est \\(p_k\\).\n\nSi \\(S \\sim p_{\\text{Poisson}(\\textbf{p})}\\) alors pour tout \\((k,l) \\in \\mathcal{U}^2, ~~ \\pi_k = \\textbf{p}_k\\) et si \\(k \\neq l~~\\), \\(\\pi_{kl} = \\textbf{p}_k \\textbf{p}_l\\)\nApplication : \\(\\displaystyle \\hat{\\mathbb{V}}_\\text{HT}(\\hat t_{y,\\text{HT}}) = \\sum_{k \\in S} y_k^2 \\frac{1-\\textbf{p}_k}{\\textbf{p}_k^2}\\)\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "presentations/pres_analytique.html#approximations-classiques",
    "href": "presentations/pres_analytique.html#approximations-classiques",
    "title": "Atelier du r√©seau sondage",
    "section": "Approximations classiques",
    "text": "Approximations classiques\n\n\nParfois, il est d√©licat de calculer les probabilit√©s d‚Äôinclusion d‚Äôordre 2.\n\n\n\n\nPour certains plans, des approximations sont utilis√©es.\n\n\n\n\nPour les plans √©quilibr√©s √† forte entropie : formule de Deville-Tiil√© (Deville et Till√© (2000)). \\[\\hat{\\mathbb{V}}_\\text{DT}(\\hat{t}_{y,\\text{HT}}) = \\frac{n}{n-d}\\sum_{k \\in S} (1 - \\pi_k) \\left(\\frac{y_k}{\\pi_k} - \\frac{x_k}{\\pi_k} \\hat{\\beta} \\right)^2\\] o√π \\(\\hat{\\beta}\\) est le coefficient estim√© sur \\(\\mathcal{S}\\) de la r√©gression de \\(\\{\\frac{y_k}{\\pi_k}\\}\\) par \\(\\{\\frac{x_k}{\\pi_k}\\} \\in \\mathbb{R}^d\\) pond√©r√©e par \\(1-\\pi_k\\).\n\nRemarque : le plan al√©atoire simple sans remise \\(p_{\\text{SASSR}(n;N)}\\) est un plan √©quilibr√© sur la variable \\(\\{\\pi_k\\}\\) \\(\\to\\) il est donc possible d‚Äôutiliser l‚Äôapproximation de Deville-Till√© et \\(\\hat{\\mathbb{V}}_\\text{DT}(\\hat{t}_{y,\\text{HT}}) = \\hat{\\mathbb{V}}_\\text{SYG}(\\hat{t}_{y,\\text{HT}}) = \\hat{\\mathbb{V}}_\\text{HT}(\\hat{t}_{y,\\text{HT}})\\)\n\n\n\n\n\nPour le tirage syst√©matique : approximation par la variance sous un plan al√©atoire simple."
  },
  {
    "objectID": "presentations/pres_analytique.html#section",
    "href": "presentations/pres_analytique.html#section",
    "title": "Atelier du r√©seau sondage",
    "section": "",
    "text": "Plan de l‚Äôenqu√™te Histoire de Vie et Patrimoine\n\n\n\nId√©e 1\n\n: utiliser les r√©sultats pr√©sent√©s. ‚ùå\n\n\n\n\n\nProbl√®me 1\n\n: le calcul des probabilit√©s d‚Äôinclusion d‚Äôordre deux est (tr√®s) d√©licat.\n\n\n\n\n\nId√©e 2\n\n: estimer les probabilit√©s d‚Äôinclusion d‚Äôordre deux par simulation. ‚ùå\n\n\n\n\n\nProbl√®me 2\n\n: l‚Äôestimation des probabilit√©s d‚Äôinclusion d‚Äôordre deux est tr√®s gourmande en ressource informatique et peut conduire √† des estimations instables.\n\n\n\n\n\nId√©e 3\n\n: d√©composer le calcul de l‚Äôestimateur de la variance degr√© par degr√©. ‚úÖ\n\n\n\n\n\nId√©e 4\n\n: utiliser des m√©thodes de r√©plication. ‚úÖ"
  },
  {
    "objectID": "presentations/pres_analytique.html#estimation-de-variance-pour-des-plans-√†-plusieurs-degr√©s-rao75",
    "href": "presentations/pres_analytique.html#estimation-de-variance-pour-des-plans-√†-plusieurs-degr√©s-rao75",
    "title": "Atelier du r√©seau sondage",
    "section": "Estimation de variance pour des plans √† plusieurs degr√©s (Rao (1975))",
    "text": "Estimation de variance pour des plans √† plusieurs degr√©s (Rao (1975))\nSoit \\(p\\) un plan de sondage √† deux degr√©s o√π \\(p_1\\) d√©signe le plan de sondage des unit√©s primaires et \\(p_{2|1}\\) le plan de sondage des unit√©s secondaires conditionnellement aux unit√©s primaires. On notera respectivement \\(s_\\text{UP}\\) et \\(s_\\text{US}\\), les √©chantillons d‚Äôunit√©s primaires et secondaires obtenus.\nOn note :\n\n\\(\\pi_u^{(1)}\\), les probabilit√©s d‚Äôinclusion d‚Äôordre 1 d‚Äôune unit√© primaire \\(u \\in U_\\text{UP}\\).\n\\(\\pi_l^{(2|1)}\\), les probabilit√©s d‚Äôinclusion d‚Äôordre 1 d‚Äôune unit√© secondaire \\(l \\in U_\\text{UP}\\) conditionnellement √† l‚Äô√©chantillon des UP.\n\\(\\pi_l^{(1,2)}\\), les probabilit√©s d‚Äôinclusion d‚Äôordre 1 d‚Äôune unit√© secondaire \\(l \\in U_\\text{UP}\\).\n\nSoit \\(\\hat{t}_{y,\\text{HT}}\\), l‚Äôestimateur d‚ÄôHorvitz-Thompson d‚Äôune variable d‚Äôint√©r√™t \\(\\{y_k\\}\\) : \\[\\hat{t}_{y,\\text{HT}} = \\sum_{k \\in S_{\\text{US}}} \\frac{y_k}{\\pi_k^{(1,2)}} = \\sum_{u \\in S_\\text{UP}} \\frac{\\hat{t}_{y,\\text{HT},u}}{\\pi_u^{(1)}} \\text{  avec  } \\hat{t}_{y,\\text{HT},u} = \\sum_{k \\in u \\cap S_\\text{US}} \\frac{y_k}{\\pi_k^{(2|1)}}\\]"
  },
  {
    "objectID": "presentations/pres_analytique.html#section-2",
    "href": "presentations/pres_analytique.html#section-2",
    "title": "Atelier du r√©seau sondage",
    "section": "",
    "text": "Supposons que :\n\n\nle tirage des unit√©s secondaires au sein des unit√©s primaires sont ind√©pendants d‚Äôune unit√© primaire √† l‚Äôautre.\n\n\n\n\nl‚Äôexistence d‚Äôun estimateur \\(\\hat{\\mathbb{V}^{1}}(\\hat{t}_{y,\\text{HT}})\\) sans biais de la variance li√© au premier degr√© d‚Äô√©chantillonnage \\(\\mathbb{V}^{1}(\\hat{t}_{y,\\text{HT}})\\) pouvant s‚Äô√©crire sous la forme \\(\\displaystyle \\hat{\\mathbb{V}} (\\hat{t}_{y,\\text{HT}}) = Q(t_{y_{(1)}}, ..., t_{y_{(n_\\text{UP})}}) = \\sum_{i} \\sum_{j \\neq i} q_{ij} t_{y_{(i)}} t_{y_{(j)}} + \\sum_{i} q_{i} t_{y_{(i)}}^2\\)\n\n\n\n\npour tout \\(u \\in \\mathcal{U}_\\text{UP}\\), l‚Äôexistence d‚Äôun estimateur sans biais \\(\\hat{t}_{y,\\text{HT},u}\\) (sous le deuxi√®me degr√©) de \\(\\displaystyle t_{y_{(u)}} = \\sum_{k \\in u} y_k\\)\n\n\n\n\npour tout \\(u \\in \\mathcal{U}_\\text{UP}\\), l‚Äôexistence d‚Äôun estimateur sans biais \\(\\hat{\\mathbb{V}}^{2|1}(\\hat{t}_{y,\\text{HT},u})\\) (sous le deuxi√®me degr√©) de la variance de l‚Äôestimateur \\(\\hat{t}_{y,\\text{HT},u}\\).\n\n\n\nSous ces hypoth√®ses, la variance totale de l‚Äôestimateur d‚ÄôHorvitz-Thompson sous le plan \\(p\\) peut √™tre estim√©e sans biais par \\[\\hat{\\mathbb{V}}^{(1,2)}(\\hat{t}_{y,\\text{HT}}) = \\hat{\\mathbb{V}}^{(1,2)}(\\{ y_{l} : l \\in S_\\text{US} \\}) =  Q(\\hat{t}_{y,\\text{HT},1}, ..., \\hat{t}_{y,\\text{HT},n_{\\text{US}}}) + \\sum_{u \\in S_\\text{UP}} \\left( \\frac{1}{(\\pi_u^{(1)})^2} - q_u \\right) \\hat{\\mathbb{V}}^{2|1}(\\hat{t}_{y,\\text{HT},u})\\]"
  },
  {
    "objectID": "presentations/pres_analytique.html#r√©capitulatif",
    "href": "presentations/pres_analytique.html#r√©capitulatif",
    "title": "Atelier du r√©seau sondage",
    "section": "R√©capitulatif",
    "text": "R√©capitulatif"
  },
  {
    "objectID": "presentations/pres_analytique.html#estimation-par-subtitution",
    "href": "presentations/pres_analytique.html#estimation-par-subtitution",
    "title": "Atelier du r√©seau sondage",
    "section": "Estimation par subtitution",
    "text": "Estimation par subtitution\n\n\nNous savons estimer la variance d‚Äôestimateurs d‚ÄôHorvitz-Thompson \\(\\displaystyle \\hat{t}_{y,\\text{HT}} = \\sum_{k \\in S} \\frac{y_k}{\\pi_k}\\) du total.\n\n\n\n\nEn pratique, on s‚Äôint√©resse √† d‚Äôautres param√®tres (univari√©s) : \\(\\theta = f(t_{y^{1}}, ..., t_{y^{d}})\\)\n\nExemple 1 : la moyenne de la variable \\(\\{y_k\\}\\) not√©e \\(\\mu_{y^{1}} = \\frac{1}{N} t_{y^{1}}\\)\nExemple 2 : le rapport des totaux des variables \\(\\{y^{1}_{k}\\}\\) et \\(\\{y^{2}_{k}\\}\\) not√© \\(R_{{y^{1}},{y^{2}}} = \\frac{t_{y^{1}}}{t_{y^{2}}}\\)\n\n\n\n\n\nComment trouver un estimateur (approximativement) sans biais ?\n\n\n\n\nPrincipe de subtitution : on remplace les param√®tres inconnus par des estimations.\n\nExemple 1 : la moyenne de la variable \\(\\frac{1}{N} \\hat{t}_{y^{1}, \\text{HT}}\\)\nExemple 2 : la moyenne de la variable \\(\\hat{R}_{{y^{1}},{y^{2}}} = \\frac{\\hat{t}_{y^{1}, \\text{HT}}}{\\hat{t}_{y^{2}, \\text{HT}}}\\)\n\n\n\n\n\nQuid de la variance ?"
  },
  {
    "objectID": "presentations/pres_analytique.html#principe-de-lin√©arisation",
    "href": "presentations/pres_analytique.html#principe-de-lin√©arisation",
    "title": "Atelier du r√©seau sondage",
    "section": "Principe de lin√©arisation",
    "text": "Principe de lin√©arisation\n\n\nLe principe de lin√©arisation va permettre d‚Äôestimer la variance d‚Äôestimateurs par subtitution.\n\n\n\n\nL‚Äôid√©e est d‚Äôapproximer la variance de l‚Äôestimateur par subtitution \\(\\mathbb{V}(f(\\hat{t}_{y^{1,\\text{HT}}, \\text{HT}}, ..., \\hat{t}_{y^{d,\\text{HT}}}))\\) par celle de l‚Äôestimateur du total d‚ÄôHorvitz-Thompson d‚Äôune variable \\(\\mathbb{V}(\\hat{t}_{u,\\text{HT}})\\).\n\n\n\n\nComment construire \\(\\{u_k\\}\\) ?\n\n\n\n\nPlusieurs approches diff√©rentes :\n\nSi \\(\\hat{\\theta} = f(\\hat{t}_{y^{1,\\text{HT}}, \\text{HT}}, ..., \\hat{t}_{y^{d,\\text{HT}}})\\) o√π \\(f\\) est diff√©rentiable.\nSi \\(\\hat{\\theta}\\) est solution d‚Äôune √©quation estimante.\nSi \\(\\hat{\\theta}\\) est une fonctionnelle."
  },
  {
    "objectID": "presentations/pres_analytique.html#approche-1-si-f-diff√©rentiable",
    "href": "presentations/pres_analytique.html#approche-1-si-f-diff√©rentiable",
    "title": "Atelier du r√©seau sondage",
    "section": "Approche 1 : si \\(f\\) diff√©rentiable",
    "text": "Approche 1 : si \\(f\\) diff√©rentiable\n\nSupposons de plus que \\(f\\) soit r√©guli√®re : \\(f\\) diff√©rentiable.\n\n\n\nEn utilisant un d√©veloppement de Taylor (cas o√π \\(f : \\mathbb{R} \\to \\mathbb{R}\\)): \\[f(\\hat{t}_{y,\\text{HT}}) \\approx f(t_y) + (\\hat{t}_{y,\\text{HT}} - t_y) f'(t_y)\\]\n\n\n\n\nPar passage √† l‚Äôesp√©rance : \\[\\mathbb{E}(f(\\hat{t}_{y,\\text{HT}})) \\approx \\mathbb{E}(f(t_y)) + \\mathbb{E}((\\hat{t}_{y,\\text{HT}} - t_y) f'(t_y)) \\approx \\mathbb{E}(f(t_y))\\] \\(\\to\\) Si l‚Äôestimateur d‚ÄôHorvitz-Thompson \\(\\hat{t}_{y,\\text{HT}}\\) est sans biais pour \\(t_y\\) alors \\(f(t_{y,\\text{HT}})\\) l‚Äôest approximativement pour \\(f(t_{y})\\). \n\n\n\n\nPar passage √† la variance : \\[\\mathbb{V}(f(\\hat{t}_{y,\\text{HT}})) \\approx \\mathbb{V}((\\hat{t}_{y,\\text{HT}} - t_y) f'(t_y)) \\approx  \\color{red}{\\mathbb{V}((\\hat{t}_{ f'(t_y) \\times y,\\text{HT}}))}\\]\n\n\n\n\nTh√©or√®me 1 (Biais de l‚Äôestimateur par subtitution) Si l‚Äôestimateur d‚ÄôHorvitz-Thompson \\(\\hat{t}_{y,\\text{HT}}\\) est sans biais pour \\(t_y\\) alors \\(\\mathbb{E}(f(\\hat{t}_{y,\\text{HT}})) - f(t_y) \\approx 0\\)."
  },
  {
    "objectID": "presentations/pres_analytique.html#approche-1-si-f-diff√©rentiable-1",
    "href": "presentations/pres_analytique.html#approche-1-si-f-diff√©rentiable-1",
    "title": "Atelier du r√©seau sondage",
    "section": "Approche 1 : si \\(f\\) diff√©rentiable",
    "text": "Approche 1 : si \\(f\\) diff√©rentiable\n\n\nLa variance d‚Äôun estimateur de la forme \\(f(\\hat t_{y,\\text{HT}})\\) est approximativement √©gale √† la variance de l‚Äôestimateur du total de la variable \\(\\{u_k\\}\\) d√©finie pour tout individu \\(k, ~~ u_k = f'(t_y) \\times y_k\\) : \\[ \\mathbb{V}(f(\\hat t_{y,\\text{HT}})) \\approx \\mathbb{V}(\\hat t_{u,HT}) \\]\n\n\n\n\nIntuitivement : la variance de \\(f(\\hat t_{y,\\text{HT}})\\) est approximativement la m√™me que celle d‚Äôun estimateur d‚ÄôHorvitz-Thompson pour une variable d‚Äôint√©r√™t bien choisie \\(\\to\\) r√¥le central de l‚Äôestimation du total.\n\n\n\n\nLa variable \\(\\{u_k\\}\\) est appel√©e variable lin√©aris√©e associ√©e √† \\(f\\).\n\n\n\n\nProbl√®me : cette variable est d√©finie pour tout individu \\(k \\in \\mathcal{U} ~~ u_k = f'(\\color{red}{t_y}\\color{black}) \\times y_k \\to\\) il est donc n√©cessaire de conna√Ætre \\(\\displaystyle t_y = \\sum_{k \\in \\mathcal{U}} y_k\\) qui est inconnu.\n\n\n\n\nSolution : estimer par subtitution la variable lin√©aris√©e \\(\\{u_k\\}\\).\n\nPour l‚Äôindividu \\(k \\in \\mathcal{U}\\), \\(u_k = f'(t_y) \\times y_k\\) sera estim√© par \\(\\hat{u}_k = f'(\\hat{t}_{y,\\text{HT}}) \\times y_k\\).\n\n\n\n\n\nLa variable \\(\\hat{u}_k\\) est la variable lin√©aris√©e estim√©e.\n\n\n\n\nTh√©or√®me 2 (Estimation de la variance par lin√©arisation - cas unidimensionnel) L‚Äôestimateur de la variance par lin√©arisation d‚Äôune fonction d‚Äôint√©r√™t de la forme \\(f(t_{y})\\) est donn√© par \\(\\displaystyle \\hat{\\mathbb{V}}_\\text{lin}(f(\\hat{t}_{y,\\text{HT}})) = \\hat{\\mathbb{V}}(\\hat t_{\\hat{u},HT})\\)"
  },
  {
    "objectID": "presentations/pres_analytique.html#exemple-de-lin√©arisation---cas-unidimensionnel",
    "href": "presentations/pres_analytique.html#exemple-de-lin√©arisation---cas-unidimensionnel",
    "title": "Atelier du r√©seau sondage",
    "section": "Exemple de lin√©arisation - cas unidimensionnel",
    "text": "Exemple de lin√©arisation - cas unidimensionnel\n\n\nOn suppose que l‚Äô√©chantillon \\(S\\) dont nous disposons soit tir√© selon un plan de sondage tel que pour tout individu \\(k \\in \\mathcal{U}, ~ \\pi_k &gt; 0\\) \\(\\to\\) l‚Äôestimateur du total d‚ÄôHorvitz-Thompson \\(\\hat{t}_{y,\\text{HT}}\\) est un estimateur sans biais de \\(t_y\\).\n\n\n\n\n\nDans cet exemple, la variable d‚Äôint√©r√™t prend des valeurs strictement positives.\n\n\n\n\nNous souhaitons estimer \\(\\log{t_y}\\) : un estimateur par subtitution est donn√© par \\(\\log{\\hat{t}_{y,\\text{HT}}}\\).\n\n\n\n\nCet estimateur est approximativement sans biais pour \\(\\log{t_y}\\) car \\(\\hat{t}_{y,\\text{HT}}\\) est sans biais pour \\(t_y\\).\n\n\n\n\nL‚Äôestimateur de la variance par lin√©arisation est donn√© par \\(\\hat{\\mathbb{V}}(\\hat t_{\\hat{u},HT})\\) o√π pour tout \\(k \\in \\mathcal{U}\\), \\(\\hat{u}_k = \\frac{y_k}{\\hat{t}_{y,\\text{HT}}}\\).\n\nIl reste √† utiliser les r√©sultats propres au plan de sondage afin de d√©terminer un estimateur de la variance."
  },
  {
    "objectID": "presentations/pres_analytique.html#lin√©arisation-dune-fonction-de-plusieurs-totaux",
    "href": "presentations/pres_analytique.html#lin√©arisation-dune-fonction-de-plusieurs-totaux",
    "title": "Atelier du r√©seau sondage",
    "section": "Lin√©arisation d‚Äôune fonction de plusieurs totaux",
    "text": "Lin√©arisation d‚Äôune fonction de plusieurs totaux\n\n\nIl est possible d‚Äôutiliser cette approche pour des fonctions de totaux de plusieurs variables d‚Äôint√©r√™t \\(f(t_{y^1}, ..., t_{y^d})\\) o√π \\(f : \\mathbb{R}^d \\to \\mathbb{R}\\) est une fonction diff√©rentiable.\n\n\n\n\nPrincipe de subtitution : un estimateur de \\(\\theta := f(t_{y^1}, ..., t_{y^d})\\) est donn√© par \\(\\hat{\\theta} := f(\\hat{t}_{y^1,\\text{HT}}, ..., \\hat{t}_{{y^d,\\text{HT}}})\\).\n\n\n\n\nM√™me id√©e : en utilisant la formule de Taylor \\[f(\\hat{t}_{y^1,\\text{HT}}, ..., \\hat{t}_{{y^d,\\text{HT}}}) \\approx f(t_{y^1}, ..., t_{y^d}) +  ( \\hat{t}_{y^1, \\text{HT}} - t_{y^1} , ..., \\hat{t}_{y^d,\\text{HT}} - t_{y^d}) \\nabla f(t_{y^1}, ..., t_{y^d})\\]\n\n\n\n\nIl est possible d‚Äôobtenir l‚Äôapproximation de la variance suivante : \\[\\mathbb{V}(f(\\hat{t}_{y^1,\\text{HT}}, ..., \\hat{t}_{{y^d,\\text{HT}}})) \\approx \\mathbb{V}(  ( \\hat{t}_{y^1, \\text{HT}}  , ..., \\hat{t}_{y^d,\\text{HT}}) \\nabla f(t_{y^1}, ..., t_{y^d})   ) = \\hat{t}_{u,\\text{HT}}\\]\n\no√π la variable \\(\\{u_k\\}_{k \\in \\mathcal{U}}\\) est d√©finie pour tout \\(k \\in \\mathcal{U}\\) par \\(u_k =  (y^1_k, ..., y^d_k) \\nabla f(t_{y^1}, ..., t_{y^d})\\)\n\n\n\n\\(u_k\\) est la variable lin√©aris√©e associ√©e √† \\(f\\) \\(\\to\\) m√™me probl√®me que dans les cas univari√© : pas acc√®s aux totaux."
  },
  {
    "objectID": "presentations/pres_analytique.html#lin√©arisation-dune-fonction-de-plusieurs-totaux-2",
    "href": "presentations/pres_analytique.html#lin√©arisation-dune-fonction-de-plusieurs-totaux-2",
    "title": "Atelier du r√©seau sondage",
    "section": "Lin√©arisation d‚Äôune fonction de plusieurs totaux (2)",
    "text": "Lin√©arisation d‚Äôune fonction de plusieurs totaux (2)\n\n\n\\(u_k\\) est la variable lin√©aris√©e associ√©e √† \\(f\\) \\(\\to\\) m√™me probl√®me que dans les cas univari√© : pas acc√®s aux totaux.\n\n\\(\\to\\) utilisation de la variable lin√©aris√©e estim√©e : \\(\\hat u_k = \\nabla f(\\hat{t}_{y^1,\\text{HT}}, ..., \\hat{t}_{y^d,\\text{HT}}) (y^1_k, ..., y^d_k)^T\\).\n\n\n\nEstimation par subtitution : \\(\\hat{\\mathbb{V}}_\\text{lin}(f(\\hat{t}_{y^1,\\text{HT}}, ..., \\hat{t}_{{y^d,\\text{HT}}})) =  \\hat{\\mathbb{V}}(  ( \\hat{t}_{y^1, \\text{HT}} , ..., \\hat{t}_{y^d,\\text{HT}} ) \\nabla f(\\hat{t}_{y^1,\\text{HT}}, ..., \\hat{t}_{{y^d},\\text{HT}})) = \\mathbb{V}(\\hat{t}_{\\hat{u},\\text{HT}})\\)\n\n\n\n\nTh√©or√®me 3 (Estimation de la variance par lin√©arisation) L‚Äôestimateur de la variance par lin√©arisation d‚Äôune fonction d‚Äôint√©r√™t de la forme \\(f(t_{y^1}, ..., t_{y^d})\\) est donn√© par \\(\\displaystyle \\hat{\\mathbb{V}}_\\text{lin}(f(\\hat{t}_{y^1,\\text{HT}}, ..., \\hat{t}_{{y^d,\\text{HT}}})) = \\mathbb{V}(  ( \\hat{t}_{y^1, \\text{HT}} , ..., \\hat{t}_{y^d,\\text{HT}}) \\nabla f(\\hat{t}_{y^1,\\text{HT}}, ..., \\hat{t}_{{y^d},\\text{HT}}))\\)"
  },
  {
    "objectID": "presentations/pres_analytique.html#exemple-de-lin√©arisation",
    "href": "presentations/pres_analytique.html#exemple-de-lin√©arisation",
    "title": "Atelier du r√©seau sondage",
    "section": "Exemple de lin√©arisation",
    "text": "Exemple de lin√©arisation\n\nSupposons que nous disposons de deux variables d‚Äôint√©r√™t \\(y^{1}\\) (par exemple, les d√©penses alimentaires) et \\(y^{2}\\) (par exemple, le revenu total) et que nous souhaitons conna√Ætre un estimateur du ratio des totaux \\(R_{y^{1}, y^{2}} = \\frac{t_{y^{1}}}{t_{y^{2}}}\\).\nL‚Äôestimateur par subtitution de \\(R_{y^{1}, y^{2}}\\) not√© \\(\\hat{R}_{y^{1}, y^{2}}\\) est donn√© par \\(\\hat{R}_{y^{1}, y^{2}} = \\frac{\\hat{t}_{y^{1},\\text{HT}}}{\\hat{t}_{y^{2},\\text{HT}}}\\) .\nCet estimateur est approximativement sans biais (le biais est d‚Äôautant plus faible que les estimateurs des totaux ont une faible variance et que la fonction d‚Äôint√©r√™t ne fluctue pas trop - on suppose que pour tout \\(k \\in \\mathcal{U}, \\pi_k &gt; 0\\)).\nQuid de la variance ?\n\nMalheureusement, \\(\\mathbb{V}(\\hat{R}_{y^{1}, y^{2}}) = \\mathbb{V}(\\frac{\\hat{t}_{y^{(1)},\\text{HT}}}{\\hat{t}_{y^{(2)},\\text{HT}}}) \\neq  \\frac{\\mathbb{V}(\\hat{t}_{y^{(1)},\\text{HT}})}{\\mathbb{V}({\\hat{t}_{y^{(2)},\\text{HT}})}}\\)\nUtilisation du principe de substitution."
  },
  {
    "objectID": "presentations/pres_analytique.html#exemple-de-lin√©arisation-2",
    "href": "presentations/pres_analytique.html#exemple-de-lin√©arisation-2",
    "title": "Atelier du r√©seau sondage",
    "section": "Exemple de lin√©arisation (2)",
    "text": "Exemple de lin√©arisation (2)\n\n\n\\(f : (x,y) \\in \\mathbb{R} \\times \\mathbb{R}^* \\to \\frac{x}{y}\\)\n\n\n\n\nPour tout \\((x,y) \\in \\mathbb{R} \\times \\mathbb{R}^*\\), \\(\\nabla f(x,y) = (\\frac{1}{y}, \\frac{-x}{y})^T\\)\n\n\n\n\nLa variable lin√©aris√©e pour un individu \\(k\\) vaut donc \\(u_k = \\frac{y^{1}_k}{t_{y^{2}}} - \\frac{t_{y^{1}}}{t_{y^{2}}^2} y^{2}_k = \\frac{1}{t_{y^{2}}} (y^{1}_k - R_{y^{1}, y^{2}} y^{2}_k)\\)\n\n\n\n\nLa variable lin√©aris√©e estim√©e pour un individu \\(k\\) vaut \\(\\hat{u}_k =  \\frac{1}{\\hat{t}_{y^{2},\\text{HT}}} (y^{1}_k - \\hat{R}_{y^{1}, y^{2}} y^{2}_k)\\)\n\n\nL‚Äôestimateur de la variance par lin√©arisation de \\(\\mathbb{V}(\\hat{R}_{y^1, y^2, \\text{sub}})\\) est \\(\\hat{\\mathbb{V}}(\\hat{t}_{\\hat{u}, \\text{HT}})\\) o√π \\(\\hat{u}_k =  \\frac{1}{\\hat{t}_{y^{2},\\text{HT}}} (y^{1}_k - \\hat{R}_{y^{1}, y^{2}} y^{2}_k)\\)."
  },
  {
    "objectID": "presentations/pres_analytique.html#lin√©arisation-par-fonction-objective",
    "href": "presentations/pres_analytique.html#lin√©arisation-par-fonction-objective",
    "title": "Atelier du r√©seau sondage",
    "section": "Lin√©arisation par fonction objective",
    "text": "Lin√©arisation par fonction objective\n\n\nCertains param√®tres d‚Äôint√©r√™t et estimateurs sont solutions d‚Äôune √©quation estimante.\n\n\n\n\nDans certains cas, une expression close du param√®tre ou de l‚Äôestimateur n‚Äôexiste pas.\n\nIl n‚Äôest pas possible de donner une expression directe de l‚Äôestimateur.\n\n\n\n\n\nIl est cependant possible d‚Äôobtenir une estimation de la variance de l‚Äôestimateur par lin√©arisation de la fonction objective.\n\n\n\n\nSoit \\(\\theta \\in \\mathbb{R}^d\\), un param√®tre tel que \\[\\begin{equation}\n\\frac{1}{N} \\sum_{k \\in \\mathcal{U}} \\phi(\\theta; x_k, y_k) = 0 \\text{  o√π  } \\phi : \\mathbb{R}^d \\to \\mathbb{R}^{d} \\text{ diff√©rentiable.}\n\\label{defparameq}\n\\end{equation}\\]\n\nExemple 1 : la moyenne \\(\\displaystyle {\\mu}_y = \\frac{1}{N} \\sum_{k \\in \\mathcal{U}} y_k\\) avec \\(\\phi(\\theta; x_k, y_k) = y_k - \\theta\\)\nExemple 2 : le coefficient de r√©gression \\(\\beta\\) de la r√©gression de \\(\\{y_k\\}\\) sur \\(\\{x_k\\}\\) avec \\(\\phi(\\theta; x_k, y_k) = x_k (y_k - x_k^T \\theta)\\)"
  },
  {
    "objectID": "presentations/pres_analytique.html#lin√©arisation-par-fonction-objective-1",
    "href": "presentations/pres_analytique.html#lin√©arisation-par-fonction-objective-1",
    "title": "Atelier du r√©seau sondage",
    "section": "Lin√©arisation par fonction objective",
    "text": "Lin√©arisation par fonction objective\n\nIl est possible de construire un estimateur associ√© \\(\\hat{\\theta}\\) tel que \\[\\begin{equation}\n\\frac{1}{N} \\sum_{k \\in S} \\frac{\\phi(\\hat{\\theta}; x_k, y_k)}{\\pi_k} = 0 \\text{  o√π  } \\phi : \\mathbb{R}^d \\to \\mathbb{R}^{d} \\text{ diff√©rentiable.}\n\\label{defestimeq}\n\\end{equation}\\]\n\nExemple 1 : l‚Äôestimateur \\(\\displaystyle \\hat{\\mu}_{y, \\text{Hayek}} = \\frac{1}{\\sum_{k \\in S}\\frac{1}{\\pi_k}} \\sum_{k \\in S} \\frac{y_k}{\\pi_k}\\) avec \\(\\phi(\\theta; x_k, y_k) = y_k - \\theta\\)\nExemple 2 : le coefficient de r√©gression estim√©e \\(\\displaystyle \\hat{\\beta} = \\left(\\sum_{k \\in S} \\frac{x_k x_k^T}{\\pi_k} \\right)^{-1} \\sum_{k \\in S} \\frac{x_k y_k}{\\pi_k}\\) de la r√©gression de \\(y\\) sur \\(x\\) avec \\(\\phi(\\theta; x_k, y_k) = x_k (y_k - x_k^T \\theta)\\)"
  },
  {
    "objectID": "presentations/pres_analytique.html#intuition-de-la-lin√©arisation-par-fonction-estimante",
    "href": "presentations/pres_analytique.html#intuition-de-la-lin√©arisation-par-fonction-estimante",
    "title": "Atelier du r√©seau sondage",
    "section": "Intuition de la lin√©arisation par fonction estimante",
    "text": "Intuition de la lin√©arisation par fonction estimante\n\nSi \\(\\phi\\) est diff√©rentiable, \\[\\phi(\\hat{\\theta}; x_k, y_k) \\approx \\phi(\\theta; x_k, y_k) + (\\text{Jac}(\\phi)(\\theta)) (\\hat{\\theta} - \\theta)\\]\nD‚Äôo√π \\[\\underbrace{\\sum_{k \\in S} \\frac{\\phi(\\hat{\\theta}; x_k, y_k)}{\\pi_k}}_{=0} \\approx \\sum_{k \\in S} \\frac{\\phi(\\theta; x_k, y_k)}{\\pi_k} + (\\sum_{k \\in S} \\frac{\\text{Jac}(\\phi)(\\theta; x_k, y_k))}{\\pi_k}) (\\hat{\\theta} - \\theta)\\]\nD‚Äôo√π \\((-\\sum_{j \\in \\mathcal{U}} {\\text{Jac}(\\phi)(\\theta; x_j, y_j))})\\) inversible : \\[\\begin{align}\n(\\hat{\\theta} - \\theta) &\\approx \\sum_{k \\in S}  (-\\sum_{j \\in S} \\frac{\\text{Jac}(\\phi)(\\theta; x_j, y_j))}{\\pi_j})^{-1} \\frac{\\phi(\\theta; x_k, y_k)}{\\pi_k} \\\\\n&\\approx \\sum_{k \\in S}  (-\\sum_{j \\in \\mathcal{U}} {\\text{Jac}(\\phi)(\\theta; x_j, y_j))})^{-1} \\frac{\\phi(\\theta; x_k, y_k)}{\\pi_k} \\\\\n&\\approx \\sum_{k \\in S} \\frac{u_k(\\theta)}{\\pi_k}\n\\end{align}\\]"
  },
  {
    "objectID": "presentations/pres_analytique.html#section-3",
    "href": "presentations/pres_analytique.html#section-3",
    "title": "Atelier du r√©seau sondage",
    "section": "",
    "text": "Th√©or√®me 4 (Estimateur de la variance par lin√©arisation de l‚Äô√©quation estimante) L‚Äôapproximation suivante \\(\\displaystyle \\mathbb{V}(\\hat{\\theta}) \\approx \\mathbb{V}(\\sum_{k \\in S} \\frac{u_k(\\theta)}{\\pi_k})\\) permet de cr√©er un estimateur \\(\\displaystyle \\hat{\\mathbb{V}}(\\hat{\\theta}) \\approx \\hat{\\mathbb{V}}(\\sum_{k \\in S} \\frac{\\widehat{u_k(\\theta)}}{\\pi_k})\\)\n\n\n\n\nLa variable \\(\\{ u_k(\\theta) \\}\\) est la variable lin√©aris√©e associ√©e √† l‚Äôestimateur \\(\\hat{\\theta}\\) \\(\\to\\) \\(\\theta\\) est inconnu.\n\n\n\n\nLa variable \\(\\{ u_k(\\hat{\\theta}) \\}\\) est la variable lin√©aris√©e estim√©e associ√©e √† l‚Äôestimateur."
  },
  {
    "objectID": "presentations/pres_analytique.html#exemple-dapplication",
    "href": "presentations/pres_analytique.html#exemple-dapplication",
    "title": "Atelier du r√©seau sondage",
    "section": "Exemple d‚Äôapplication",
    "text": "Exemple d‚Äôapplication\n\nExemple 2 : le coefficient de r√©gression estim√©e \\(\\displaystyle \\hat{\\beta} = \\left(\\sum_{k \\in S} \\frac{x_k x_k^T}{\\pi_k} \\right)^{-1} \\sum_{k \\in S} \\frac{x_k y_k}{\\pi_k}\\) de la r√©gression de \\(y\\) sur \\(x\\) avec \\(\\phi(\\theta; x_k, y_k) = x_k (y_k - x_k^T \\theta)\\)\n\\(\\text{Jac}(\\phi)(\\theta; x_j, y_j) = x_k x_k^T\\)\n\\(u_k^\\text{est}(\\theta) = \\left(- \\sum_{k \\in \\mathcal{U}} x_j x_j^T \\right)^{-1} {x_k}({y_k - x_k^T \\theta})\\)\nApplication de l‚Äôestimateur \\(\\displaystyle \\hat{\\mathbb{V}}\\) de la variance d‚Äôun total √† \\(\\widehat{u_k^\\text{est}(\\hat{\\beta})} = \\left(- \\sum_{k \\in S} \\frac{x_j x_j^T}{\\pi_k} \\right)^{-1} {x_k}({y_k - x_k^T \\hat{\\beta}})\\)\n\n\n\n\n\n\n\nImportant\n\n\n\nIl s‚Äôagit d‚Äôune version all√©g√©e de la lin√©arisation sur √©quation estimante : beaucoup d‚Äôhypoth√®ses ont √©t√© cach√©es.\nCes hypoth√®ses sont parfois techniques et difficilement v√©rifiables en pratique.\nNe pas h√©sitez √† v√©rifier l‚Äôimpl√©mentation des estimations par lin√©arisation sur des exemples simples en utilisant des simulations."
  },
  {
    "objectID": "presentations/pres_analytique.html#r√©capitulatif-1",
    "href": "presentations/pres_analytique.html#r√©capitulatif-1",
    "title": "Atelier du r√©seau sondage",
    "section": "R√©capitulatif",
    "text": "R√©capitulatif\n\nR√©capitulatif"
  },
  {
    "objectID": "presentations/pres_analytique.html#calage-sur-marges",
    "href": "presentations/pres_analytique.html#calage-sur-marges",
    "title": "Atelier du r√©seau sondage",
    "section": "Calage sur marges",
    "text": "Calage sur marges\n\n\nLa calage sur marges consiste √† chercher les poids les plus proches des poids initiaux en respectant des contraintes sur l‚Äôestimation des marges.\n\n\n\n\nFormellement, les poids cal√©s sont solution du programme d‚Äôoptimisation : \\[\\min_{w \\in \\mathbb{R}^n} \\sum_{k \\in S} d_k G(\\frac{w_k}{d_k}) \\text{ sous contrainte que } \\sum_{k \\in S} w_k \\textbf{x}_k = t_\\textbf{x}\\] o√π \\(G\\) est une pseudo-distance/divergence qui quantifie l‚Äô√©cart entre les poids initiaux et les poids cal√©s.\n\n\n\n\nL‚Äôestimateur cal√© du total d‚Äôune variable \\(\\{y_k\\}\\) s‚Äô√©crit \\(\\displaystyle \\hat{t}_{y,\\text{cal}} = \\sum_{k \\in S} w_k(\\color{red}S\\color{black}) y_k\\) \\(\\to\\) il n‚Äôest pas possible d‚Äôutiliser les estimateurs de la variance d‚Äôun estimateur du total classique. üò¢\n\n\n\n\nDeville et Sarndal (1992)1 montre qu‚Äôil est possible d‚Äôapproximer la variance d‚Äôun estimateur cal√© en utilisant :\n\nun estimateur de la variance d‚Äôun estimateur du total classique. üòÅ\nles r√©sidus de la r√©gression de la variable d‚Äôint√©r√™t \\(\\{y_k\\}\\) sur \\(\\{\\textbf{x}_k\\}\\) pond√©r√©e par les poids initiaux.\n\n\n\n\n\nPas de d√©pendances au choix de \\(G\\)2 : toutes les m√©thodes sont asymptotiquement √©quivalentes au sens de la variance.\n\n\nKim et Park (2010) pour une lecture plus d√©taill√©e.Pour les formes usuelles."
  },
  {
    "objectID": "presentations/pres_analytique.html#calage-sur-marges-1",
    "href": "presentations/pres_analytique.html#calage-sur-marges-1",
    "title": "Atelier du r√©seau sondage",
    "section": "Calage sur marges",
    "text": "Calage sur marges\n\nTh√©or√®me 5 (Estimation de la variance d‚Äôun estimateur du total cal√©) L‚Äôestimateur de la variance d‚Äôun estimateur du total cal√© est \\(\\hat{\\mathbb{V}}^\\text{cal}(\\hat{t}_{y,\\text{cal}}) = \\hat{\\mathbb{V}}(\\hat{t}_{\\varepsilon,\\text{HT}})\\) o√π \\(\\hat{\\mathbb{V}}\\) est un estimateur de la variance d‚Äôun estimateur du total d‚ÄôHorvitz-Tompson et \\(\\{\\varepsilon_k\\}\\) d√©signe les r√©sidus de la r√©gression pond√©r√©e de \\(\\{y_k\\}\\) sur \\(\\{x_k\\}\\).\n\n\ngustave dispose d‚Äôune fonction permettant de r√©cup√©rer les r√©sidus de la r√©gression :\n\nExemple d‚Äôun estimateur cal√© tir√© selon un \\(\\text{SASSR}(100;200)\\)\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "presentations/pres_analytique.html#r√©capitulatif-2",
    "href": "presentations/pres_analytique.html#r√©capitulatif-2",
    "title": "Atelier du r√©seau sondage",
    "section": "R√©capitulatif",
    "text": "R√©capitulatif\n\nR√©capitulatif"
  },
  {
    "objectID": "presentations/pres_analytique.html#partage-des-poids",
    "href": "presentations/pres_analytique.html#partage-des-poids",
    "title": "Atelier du r√©seau sondage",
    "section": "Partage des poids",
    "text": "Partage des poids\n\n\n\n\n\nPartage des poids\n\n\n\n\nLe partage des poids permet de calculer les poids lorsque :\n\nLe plan de sondage est indirect,\nPlusieurs bases de sondage sont mobilis√©es,\nUn panel est utilis√©.\n\nCette m√©thode permet de prendre en compte qu‚Äôun individu de la population-fille aurait pu √™tre tir√© de plusieurs mani√®res / √† plusieurs instants diff√©rents.\n\\(L_{ij} = 1\\) si l‚Äôindividu \\(i\\) est la m√®re de l‚Äôindividu \\(j\\) et \\(\\displaystyle L_{\\bullet j} = \\sum_{k \\in \\color{red} \\mathcal{U} \\color{black}} L_{kj}\\).\nApplication : le poids d‚Äôun m√©nage \\(j \\in S_\\text{fille}\\) est \\(\\displaystyle w^\\text{fille}_{j} = \\sum_{k \\in \\mathcal{U_\\text{m√®re}}} w^\\text{m√®re}_{k} \\frac{L_{kj}}{L_{\\bullet j}}I^\\text{m√®re}_k\\)\nApplication √† l‚Äôestimation de la variance : \\[\\mathbb{V}(\\sum_{j \\in S_\\text{fille}} w^\\text{fille}_{j} y_j) = \\mathbb{V}(\\sum_{k \\in S_\\text{m√®re}} w^\\text{m√®re}_{k} z_k)\\] o√π \\(\\displaystyle z_k = \\sum_{j \\in S_\\text{fille}} \\frac{L_{kj}}{L_{\\bullet j}} y_i\\)"
  },
  {
    "objectID": "presentations/pres_analytique.html#r√©capitulatif-3",
    "href": "presentations/pres_analytique.html#r√©capitulatif-3",
    "title": "Atelier du r√©seau sondage",
    "section": "R√©capitulatif",
    "text": "R√©capitulatif\n\nR√©capitulatif"
  },
  {
    "objectID": "presentations/pres_analytique.html#il-√©tait-une-fois-gustave",
    "href": "presentations/pres_analytique.html#il-√©tait-une-fois-gustave",
    "title": "Atelier du r√©seau sondage",
    "section": "Il √©tait une fois, gustave ‚Ä¶",
    "text": "Il √©tait une fois, gustave ‚Ä¶\n\ngustave est un package d√©velopp√© en R √† l‚ÄôInsee en 2018.\nIl permet de :\n\nAider au calcul de variance,\nProposer un cadre consistant,\nR√©utiliser des op√©rations d√©j√† implement√©es,\nDiffuser les r√©sultats sans que l‚Äôutilisateur ait besoin de connaissance en sondage.\n\nCe que gustave n‚Äôest pas :\n\nUn package qui estime automatiquement la variance fonctionnant pour tous les plans.\n\n\n\n\n\n\n\n\nImportant\n\n\nUn package proposant une estimation de la variance bas√©e uniquement sur des poids (sans autre prise en compte du plan de sondage) se base a priori sur des hypoth√®ses (trop ?) simplificatrices."
  },
  {
    "objectID": "presentations/pres_analytique.html#variance-wrapper",
    "href": "presentations/pres_analytique.html#variance-wrapper",
    "title": "Atelier du r√©seau sondage",
    "section": "variance wrapper",
    "text": "variance wrapper\n\nLes estimations de variance sont livr√©es sous la forme de fonction : les variance wrappers.\nCes fonctions permettent √† l‚Äôutilisateur, √† partir de ces donn√©es, d‚Äôobtenir une estimation de la variance mais aussi des intervalles de confiance.\nPas besoin de chercher les donn√©es n√©cessaires (dans les m√©andres de nos coffres) : toutes les donn√©es sont cach√©es1 dans la fonction.\n\n\n\n\n\n\n\nImportant\n\n\nPour certaines enqu√™tes, il est n√©cessaire de mobiliser des informations potentiellement confidentielles durant l‚Äôestimation de la variance (par exemple, des variables de calage sensibles) : la diffusion de la fonction variance wrapper entra√Æne la diffusion de ces donn√©es.\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nElles sont dans l‚Äôenvironnement associ√© √† la fonction."
  },
  {
    "objectID": "presentations/pres_analytique.html#construction-dun-variance-wrapper",
    "href": "presentations/pres_analytique.html#construction-dun-variance-wrapper",
    "title": "Atelier du r√©seau sondage",
    "section": "Construction d‚Äôun variance wrapper",
    "text": "Construction d‚Äôun variance wrapper\n\nComment ces estimations sont calcul√©es ?\nComment construire ce variance wrapper ? \nTravail m√©thodologique en amont :\n\nProposition d‚Äôun estimateur de la variance d‚Äôun estimateur du total (cal√©, Hovitz-Thompson, ‚Ä¶) :\n\nOn pourra utiliser les r√©sultats sur l‚Äôestimation de variance de l‚Äôestimateur cal√©, par tirage indirect ‚Ä¶\n\nImpl√©mentation sous la forme d‚Äôune fonction simple en R / les donn√©es utilis√©es dans ce calcul seront stock√©es dans une liste.\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "presentations/pres_analytique.html#construction-dun-variance-wrapper-1",
    "href": "presentations/pres_analytique.html#construction-dun-variance-wrapper-1",
    "title": "Atelier du r√©seau sondage",
    "section": "Construction d‚Äôun variance wrapper",
    "text": "Construction d‚Äôun variance wrapper\n\nCr√©ation d‚Äôun variance wrapper √† partir de cette fonction qui :\n\nAidera √† g√©rer les lin√©arisations,\nIncorporera les donn√©es.\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPour la diffusion, il suffit de livrer le variance_wrapper :\n\nPar exemple, en enregistrant la fonction dans un fichier .rData."
  },
  {
    "objectID": "presentations/pres_analytique.html#r√©capitulatif-4",
    "href": "presentations/pres_analytique.html#r√©capitulatif-4",
    "title": "Atelier du r√©seau sondage",
    "section": "R√©capitulatif",
    "text": "R√©capitulatif"
  },
  {
    "objectID": "presentations/pres_analytique.html#lin√©arisation-et-statistic-wrapper",
    "href": "presentations/pres_analytique.html#lin√©arisation-et-statistic-wrapper",
    "title": "Atelier du r√©seau sondage",
    "section": "Lin√©arisation et statistic wrapper",
    "text": "Lin√©arisation et statistic wrapper\n\nComment gustave sait commment lin√©ariser les fonctions d‚Äôint√©r√™t ?\nUtilisation des statistic wrapper - fonction permettant de :\n\nCalculer un estimateur d‚Äôune fonction d‚Äôint√©r√™t √† partir des variables d‚Äôint√©r√™t et d‚Äôautres donn√©es.\nCalculer la lin√©aris√©e estim√©e.\n\ngustave contient de base plusieurs statistic wrapper :\n\ngustave:::mean, gustave:::total, gustave:::ratio, gustave:::diff_of_ratio ‚Ä¶\nMais comment faire si on souhaite estimer d‚Äôautres param√®tres ? üò¢\n\nIl est possible d‚Äôen d√©finir simplement avec la fonction define_statistic_wrapper."
  },
  {
    "objectID": "presentations/pres_analytique.html#exemple-de-d√©finition-dun-statistic-wrapper",
    "href": "presentations/pres_analytique.html#exemple-de-d√©finition-dun-statistic-wrapper",
    "title": "Atelier du r√©seau sondage",
    "section": "Exemple de d√©finition d‚Äôun statistic wrapper",
    "text": "Exemple de d√©finition d‚Äôun statistic wrapper\n\n(Re)-d√©finition d‚Äôun statistic wrapper pour la lin√©aris√©e du ratio : ratio2\ndefine_statistic_wrapper n√©cessite de renseigner :\n\nune fonction calculant la fonction d‚Äôint√©r√™t et les lin√©aris√©es estim√©es. Cette fonction renvoie une liste avec a minima deux √©l√©ments nomm√©s :\n\npoint : Estimation ponctuelle de la fonction d‚Äôint√©r√™t.\nlin : Vecteur contenant la lin√©aris√©e estim√©e.\n\nune liste contenant pour chaque argument de la fonction en argument de statistic_function un type parmi \"num\", \"denom\" ou \"weights\"\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "presentations/pres_analytique.html#bibliographie",
    "href": "presentations/pres_analytique.html#bibliographie",
    "title": "Atelier du r√©seau sondage",
    "section": "Bibliographie",
    "text": "Bibliographie\n\n\nBerger, Yves G. 1998. ¬´¬†Rate of convergence for asymptotic variance of the Horvitz‚ÄìThompson estimator¬†¬ª. Journal of Statistical Planning and Inference 74: 149‚Äë68.\n\n\nChauvet, Guillaume. 2015. ¬´¬†Coupling methods for multistage sampling¬†¬ª. Annals of Statistics 43: 2484‚Äë2506.\n\n\nDeville, Jean-Claude, et Carl-Erik Sarndal. 1992. ¬´¬†Calibration Estimators in Survey Sampling¬†¬ª. Journal of the American Statistical Association 87 (418): 376‚Äë82. http://www.jstor.org/stable/2290268.\n\n\nDeville, Jean-Claude, et Yves Till√©. 2000. ¬´¬†Echantillonnage √©quilibre par la m√©thode du cube, variance et estimation¬†¬ª. Acte des JMS.\n\n\nH√°jek, Jaroslav. 1960. ¬´¬†Limiting distributions in simple random sampling from a finite population¬†¬ª. Publications of the Mathematical Institute of the Hungarian Academy of Sciences 5: 361‚Äë74.\n\n\nKim, Jae Kwang, et Mingue Park. 2010. ¬´¬†Calibration Estimation in Survey Sampling¬†¬ª. International Statistical Review / Revue Internationale de Statistique 78 (1): 21‚Äë39. http://www.jstor.org/stable/27919793.\n\n\nRao, JNK. 1975. ¬´¬†Unbiased variance estimation for multistage designs¬†¬ª. Sankhya."
  },
  {
    "objectID": "presentations/pres_analytique.html#sec-icidd",
    "href": "presentations/pres_analytique.html#sec-icidd",
    "title": "Atelier du r√©seau sondage",
    "section": "Annexe 1 : Rappel sur les intervalles de confiance",
    "text": "Annexe 1 : Rappel sur les intervalles de confiance\n\n\n\n\nIntervalle de confiance\n\n\nUn intervalle de confiance (resp. par exc√®s) de niveau \\(1 - \\alpha\\) pour le param√®tre \\(\\theta\\) est un intervalle d√©fini par deux variables al√©atoires \\(\\underline{\\hat \\theta}\\) et \\(\\bar{\\hat \\theta}\\) telles que \\[\\mathbb{P}(\\theta \\in [\\underline{\\hat \\theta}, \\bar{\\hat \\theta}]) = 1 - \\alpha \\text{ (resp } \\geq 1 - \\alpha)\\]\n\n\n\n\n\n\n\n\nIntervalle de confiance asymptotique\n\n\nUn intervalle de confiance asymptotique (resp. par exc√®s) de niveau \\(1 - \\alpha\\) pour le param√®tre \\(\\theta\\) est un intervalle d√©fini par deux suites de variables al√©atoires \\((\\underline{\\hat \\theta_n})_{n \\in \\mathbb{N}}\\) et \\((\\bar{\\hat \\theta_n})_{n \\in \\mathbb{N}}\\) telles que \\[\\lim_{n \\to \\infty} \\mathbb{P}(\\theta \\in [\\underline{\\hat \\theta_n}, \\bar{\\hat \\theta_n}]) = 1 - \\alpha \\text{ (resp } \\geq 1 - \\alpha)\\]\n\n\n\n\n\nG√©n√©ralement :\n\nles intervalles de confiance non asymptotiques sont utilisables si on conna√Æt la distribution de l‚Äô√©chantillon.\nles intervalles de confiance asymptotique repose sur la normalit√© asymptotique de l‚Äôestimateur :\n\ndans le cadre traditionnel (population infinie, iid) : le th√©or√®me central limite."
  },
  {
    "objectID": "presentations/pres_analytique.html#th√©or√®me-central-limite",
    "href": "presentations/pres_analytique.html#th√©or√®me-central-limite",
    "title": "Atelier du r√©seau sondage",
    "section": "Th√©or√®me central limite",
    "text": "Th√©or√®me central limite\n\n\n\nTh√©or√®me central limite - cadre hors sondage\n\n\nSoit \\(\\{X_1, ..., X_n\\}\\), \\(n\\) variables al√©atoires iid telles que \\(\\mathbb{E}(X_1) = \\mu\\) et \\(\\mathbb{V}(X_1) &lt; \\infty\\). Le th√©or√®me central limite assure que : \\[\\frac{1}{\\mathbb{V}( \\frac{1}{n} \\sum_{k = 1}^n X_k)^{\\frac{1}{2}}} \\left( \\frac{1}{n} \\sum_{k = 1}^n X_k - \\mu \\right) = \\frac{\\sqrt{n}}{\\mathbb{V}(X_1)^{\\frac{1}{2}}} \\left( \\frac{1}{n} \\sum_{k = 1}^n X_k - \\mu \\right) \\hookrightarrow \\mathcal{N}(0, 1)\\] o√π \\(\\hookrightarrow\\) d√©signe la convergence en loi.\n\n\n\n\n\n\n\n\nUtilisation possible pour d√©terminer un intervalle de confiance asymptotique pour l‚Äôesp√©rance\n\\[[\\bar{X_n} - \\frac{\\mathbb{V}(X_1)^{\\frac{1}{2}}}{\\sqrt{n}} q_{1 - \\frac{\\alpha}{2}} , \\bar{X_n} + \\frac{\\mathbb{V}(X_1)^{\\frac{1}{2}}}{\\sqrt{n}} q_{1 - \\frac{\\alpha}{2}} ]\\] o√π \\(q_{1 - \\frac{\\alpha}{2}}\\) est le quantile d‚Äôordre \\(1-\\frac{\\alpha}{2}\\) de la loi normale centr√©e r√©duite, est un intervalle de confiance asymptotique au niveau \\(1-\\alpha\\) pour \\(\\bar{X}_n\\).\n\n\n\nRetour au cours"
  },
  {
    "objectID": "presentations/var_gustave.html",
    "href": "presentations/var_gustave.html",
    "title": "Estimation de variance analytique avec gustave",
    "section": "",
    "text": "gustave est un package permettant d‚Äôestimer la variance d‚Äôestimateurs dans un contexte d‚Äô√©chantillonnage en population finie. Ce package s‚Äôinscrit dans une logique d‚Äôharmonisation des programmes √† l‚ÄôInsee introduite avec la macro Calker en SAS. Ce package simplifie les estimations de variance analytique en mutualisant des op√©rations mobilis√©es dans plusieurs enqu√™tes et en imposant une distinction entre les enjeux m√©thodologiques et de diffusion. gustave garde un niveau d‚Äôabstraction suffisant afin de pouvoir ajouter simplement des sp√©cificit√©s propres √† certaines enqu√™tes.\nL‚Äôestimation de la variance avec gustave peut se d√©composer en trois √©tapes¬†: calcul d‚Äôun estimateur de la variance d‚Äôun estimateur d‚Äôun total, impl√©mentation de l‚Äôestimateur et utilisation des variables lin√©aris√©es.\nAfin d‚Äôillustrer le cheminement permettant d‚Äôobtenir les estimations de variance avec gustave, nous proposons d‚Äôestimer la pr√©cision dans le cadre d‚Äôun exemple. Nous consid√©rons un tirage √† deux degr√©s selon des sondages al√©atoires simples sans remise :\n\nun tirage d‚Äôun √©chantillon de \\(n_\\text{UP} =  1 000\\) unit√©s primaires \\(S_\\text{UP}\\), r√©parties en cinq strates, parmi \\(N_\\text{UP} = 10 000\\) selon un plan al√©atoire simple stratifi√© avec allocation proportionnelle,\nun tirage de \\(n_u = 4\\) unit√©s secondaires parmi les \\(N_u = 10\\) unit√©s secondaires dont chaque unit√© primaire \\(u\\) dispose. L‚Äô√©chantillon des unit√©s secondaires obtenu est not√© \\(S_\\text{US}\\). Un calage sur marges est ensuit√© r√©alis√© au niveau des unit√©s secondaires sur cinq variables quantitivatives \\(\\{ \\textbf{x}^\\text{cal}_k \\}_{k \\in S_ \\text{US}}\\) o√π pour tout \\(k\\), \\(\\textbf{x}^\\text{cal}_k = (\\textbf{x}^\\text{cal}_{k,1}, ..., \\textbf{x}^\\text{cal}_{k,5})\\) : la pond√©ration cal√©e est not√©e \\(\\{w^\\text{cal}_k\\}_{k \\in S_\\text{US}}\\). La m√©thode mobilis√©e est lin√©aire.\n\nLes donn√©es sont t√©l√©chargeables √† l‚Äôadresse suivante.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nLe fichier .Rdata contient trois tables info_ech, var_ech_cal, var_interet dont le contenu est d√©crit par les dictionnaires suivants :\n\n\n\n\n\n\n\nNom de la variable\nD√©finition\n\n\n\n\nid_psu\nIdentifiant de l‚Äôunit√© primaire.\n\n\nstrate_psu\nStrate de l‚Äôunit√© primaire.\n\n\nid_ssu\nIdentifiant de l‚Äôunit√© secondaire.\n\n\npi_psu\nProbabilit√© d‚Äôinclusion d‚Äôordre 1 de l‚Äôunit√© primaire.\n\n\npi_ssu_cond_psu\nProbabilit√© d‚Äôinclusion d‚Äôordre 1 de l‚Äôunit√© secondaire cond.aux unit√©s primaires.\n\n\npoids_avant_calage\nPoids avant calage.\n\n\npoids_apres_calage\nPoids apr√®s calage.\n\n\n\n\n\n\nNom de la variable\nD√©finition\n\n\n\n\nid_psu\nIdentifiant de l‚Äôunit√© primaire.\n\n\nid_ssu\nIdentifiant de l‚Äôunit√© secondaire.\n\n\nvar_caln\nVariable de calage \\(n\\)\n\n\n\n\n\n\nNom de la variable\nD√©finition\n\n\n\n\nidentifiant\nIdentifiant de l‚Äôunit√© secondaire.\n\n\ny\nVariable d‚Äôint√©r√™t \\(y\\)\n\n\nz\nVariable d‚Äôint√©r√™t \\(z\\)\n\n\n\n\n\n\n\n\n\nObjectifs\n\n\n\nDans cet exercice, nous souhaitons produire deux estimateurs de variance bas√©s sur deux variables d‚Äôint√©r√™t \\(\\{y_k \\}_{k \\in S_\\text{US}}\\) et \\(\\{z_k \\}_{k \\in S_\\text{US}}\\) :\n\n\\(\\displaystyle \\widehat{\\mathbb{V}}(\\hat{t}_{z,\\text{cal}})\\), un estimateur de la variance de \\(\\displaystyle \\sum_{k \\in S_\\text{US}} z_k w_k^\\text{cal}\\),\n\\(\\displaystyle  \\widehat{\\mathbb{V}}(\\frac{\\hat{t}_{y,\\text{cal}}}{\\hat{t}_{z,\\text{cal}}})\\), un estimateur de la variance de \\(\\displaystyle \\frac{\\sum_{k \\in S_\\text{US}} y_k w_k^\\text{cal}}{\\sum_{k \\in S_\\text{US}} z_k w_k^\\text{cal}}\\).\n\\(\\displaystyle  \\widehat{\\mathbb{V}}(\\log({\\hat{t}_{z,\\text{cal}}}))\\), un estimateur de la variance de \\(\\displaystyle \\log({\\hat{t}_{z,\\text{cal}}})\\).\n\n\n\n\n\n\n\nAfin d‚Äôestimer la variance d‚Äôune statistique r√©guli√®re, il est n√©cessaire de proposer un estimateur dans le cas simple de l‚Äôestimateur du total. Ce travail, r√©alis√© par le m√©thodologue, consiste √† utiliser des r√©sultats th√©oriques et l‚Äôinformation sur la collecte (plan de sondage, redressements, ‚Ä¶) afin d‚Äôapprocher au mieux un estimateur sans biais de la variance.\nDans certains cas simples (cas d‚Äôun sondage al√©atoire simple sans remise), il n‚Äôest pas n√©cessaire d‚Äôimpl√©menter l‚Äôestimateur : des fonctions pr√™tes √† l‚Äôemploi sont disponibles (fonction qvar par exemple).\nUn estimateur de la variance d‚Äôun estimateur du total d‚ÄôHorvitz-Thompson \\(\\hat{t}_{y,\\text{HT}}\\) sous le plan de l‚Äôexemple est :\n\\[\n    \\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{HT}}) = \\sum_{\\text{st} = 1}^{n_\\text{st}} \\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{HT},\\text{st}})\n\\]\no√π \\[\\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{HT},\\text{st}}) = \\frac{N^2_{\\text{UP}\\cap \\text{st}}}{n_{\\text{UP}\\cap  \\text{st}}} \\left(1-\\underbrace{\\frac{n_{\\text{UP} \\cap \\text{st}}}{N_{\\text{UP}\\cap \\text{st}}}}_{= f_\\text{up}} \\right) s^2_{\\{\\hat{t}_{y,\\text{HT}, u}\\}_{u \\in S_\\text{UP} \\cap \\text{st}}} + \\frac{N_{\\text{UP}\\cap \\text{st}}}{n_{\\text{UP}\\cap \\text{st}}} \\left( \\sum_{u \\in S_\\text{UP} \\cap \\text{st}}  \\frac{N^2_u}{n_u} (1 - \\underbrace{\\frac{n_u}{N_u}}_{=f_u}) s^2_{\\{{y_k}\\}_{k \\in S_\\text{US}   \\cap u}}\\right) \\tag{1}\\]\no√π pour tout \\(u\\in S_\\text{UP}\\), \\(\\displaystyle  \\hat{t}_{y,\\text{HT},u} = \\frac{N_u}{n_u}\\sum_{k \\in S_\\text{US} \\cap u} {y_k}\\) et \\(s^2_{\\{\\hat{t}_{y,\\text{HT}, u}\\}_{u \\in S_\\text{UP}}}\\) (resp. \\(s^2_{\\{y_k}\\}_{k \\in S_\\text{US}   \\cap u}\\)) d√©signe la dispersion de la variable \\(\\{{\\hat{t}_{y,\\text{HT}, u}}\\}_{u \\in S_\\text{UP}}\\) (resp. \\({\\{y_k\\}}_{k \\in S_\\text{US} \\cap u}\\)) sur l‚Äô√©chantillon \\(S_\\text{UP}\\) (resp. \\(S_\\text{US} \\cap u\\)).\n\n\n\n\n\n\nPreuve de l‚Äôexpression de \\(\\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{HT},\\text{st}})\\)\n\n\n\n\n\nIl suffit d‚Äôappliquer la formule de Rao en utilisant l‚Äôestimateur de Sen-Yen-Grundy pour la variance d‚Äôun estimateur du total sous un plan al√©atoire simple sans remise d‚Äôo√π \\(q_u = \\frac{N_{\\text{UP} \\cap \\text{st}}^2}{n_{\\text{UP} \\cap \\text{st}}^2} \\left( 1-f \\right)\\) et \\(\\pi_u^{(1)} = \\frac{n_{\\text{UP}}}{N_{\\text{UP}}}\\).\n\n\n\n\n\n\nUn estimateur de variance d‚Äôun estimateur cal√© peut √™tre calcul√© en utilisant les r√©sultats asymptotiques propos√©s par : un estimateur de la variance de l‚Äôestimateur \\(\\displaystyle \\sum_{k \\in S_\\text{US}} w^\\text{cal}_k y_k\\) dont la pond√©ration est cal√©e sur la variable \\(\\{  \\textbf{x}^\\text{cal}_k\\}_{k \\in S_\\text{US}}\\) est approximativement celle de l‚Äôestimateur d‚ÄôHorvitz-Thompson des r√©sidus \\(\\{\\varepsilon_k\\}_{k \\in S_\\text{US}}\\) de la r√©gression pond√©r√©e (par les poids avant calage) de \\(\\{y_k\\}_{k \\in S_\\text{US}}\\) sur \\(\\{\\textbf{x}_k\\}_{k \\in S_\\text{US}}\\) estim√©e sur \\(S_\\text{US}\\).\nIl en vient que :\n\\[\n\\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{cal}}) \\approx \\widehat{\\mathbb{V}}(\\hat{t}_{\\varepsilon,\\text{HT}})\n\\tag{2}\\]\n\n\n\nEn r√©unissant l‚ÄôEquation¬†1 et l‚ÄôEquation¬†2, il en vient que : \\[\\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{cal}}) \\approx \\sum_{\\text{st} = 1}^{n_\\text{st}} \\widehat{\\mathbb{V}}(\\hat{t}_{\\varepsilon,\\text{HT},\\text{st}})\\]\n\n\n\n\n\n\nLa fonction calcul_var correspond √† l‚Äôimpl√©mentation de l‚Äôestimateur construit pr√©c√©demment.\nCet estimateur d√©pend de :\n\nla variable d‚Äôint√©r√™t y,\ndes r√©sidus de la r√©gression de la variable y sur x,\nla fraction de sondage au premier degr√© f_up,\nla fraction de sondage au second degr√© f_us,\nla strate de chaque individu strate\n\nCes √©l√©ments seront donc des arguments de la fonction calcul_var.\n\n\n\nL‚Äôestimateur de variance propos√© n√©cessite le calcul des r√©sidus de la r√©gression de la variable d‚Äôint√©r√™t \\(\\{y_k\\}\\) sur les variables d‚Äôint√©r√™t \\(\\{\\textbf{x}_k\\}\\). Ce calcul n√©cessite donc de conna√Ætre ‚Ä¶ la variable d‚Äôint√©r√™t \\(\\{y_k\\}\\). Pour autant, certaines composantes peuvent √™tre pr√©calcul√©es en amont.\nDans le cas des r√©sidus de la r√©gression de la variable d‚Äôint√©r√™t \\(\\{y_k\\}\\) sur les variables d‚Äôint√©r√™t \\(\\{\\textbf{x}_k\\}\\), il est possible de calculer l‚Äôinverse de la matrice \\(\\displaystyle \\sum_{k \\in S} \\frac{\\textbf{x}_k \\textbf{x}_k^T}{\\pi_k}\\) qui interviendra dans tous les calculs de r√©sidus (et ind√©pendamment de la variable \\(\\{\\textbf{x}_k\\}\\)).\ngustave permet de stocker ces informations dans un format consistant et de r√©utiliser ces informations facilement. Il s‚Äôagit des precalc\nComme vu durant la pr√©sentation, la fonction res_cal permet de r√©cup√©rer les r√©sidus :\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nSi la variable d‚Äôint√©r√™t n‚Äôest pas disponible, il est possible de pr√©calculer certains √©l√©ments entrants dans le calcul des r√©sidus. Dans ce cas, il faudra renseigner NULL √† l‚Äôargument y.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nLe r√©sultat lorsque y est renseign√© est de la m√™me forme que y.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nPar contre, lorsque y = NULL, la fonction renvoie un precalc (formellement, il s‚Äôagit d‚Äôune liste). Cette liste contient les poids de sondage, la matrice des variables auxiliaires et l‚Äôinverse de la matrice de Gram inv.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nprecalc et argument id : permutation\n\n\n\nIl est recommand√© de :\n\nfaire en sorte que y soit toujours une matrice (√† une colonne dans notre cas univari√©),\navoir des lignes nomm√©es pour la matrice y et de renseigner l‚Äôargument id afin que gustave puisse v√©rifier au moment de l‚Äôapplication de la fonction res_cal si les valeurs renseign√©es dans le precalc et dans l‚Äôargument y sont dans le m√™me ordre.\n\nSi ce n‚Äôest pas le cas, gustave renvoie une erreur.\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\n\n\nprecalc et absence d‚Äôargument id\n\n\n\nSi les lignes de la variable y ne sont pas nomm√©es ou si l‚Äôargument id n‚Äôa pas √©t√© compl√©t√© au moment de la d√©finition du precalc alors aucune v√©rification ne pourra √™tre r√©alis√©e.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\nL‚Äôimpl√©mentation de l‚Äôestimateur peut-√™tre d√©compos√©e en plusieurs √©tapes :\n\ncalcul des r√©sidus √† l‚Äôaide de la fonction gustave::res_cal,\ncalcul des estimations des totaux dans chaque unit√© primaire √† l‚Äôaide de la fonction gustave::sum_by et de la fraction de sondage f_us\ncalcul de la variance de premier degr√© en utilisant la\ncalcul de la variance du second degr√©.\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nConseil pour l‚Äôimpl√©mentation de la fonction calculant la variance\n\n\n\nIl est recommand√© de construire la fonction calcul_var en faisant comme si y √©tait une matrice (√©ventuellement √† une colonne) : cela permettra de pouvoir estimer la variance de plusieurs fonctions d‚Äôint√©r√™t plus rapidement.\n\n\n\n\n\nL‚Äôimpl√©mentation de l‚Äôestimateur passe par la d√©finition d‚Äôun variance wrapper. Le variance wrapper contient toutes les informations n√©cessaires pour l‚Äôestimation. Il prend en argument une table contenant les variables d‚Äôint√©r√™t ainsi qu‚Äôune expression d√©crivant un estimateur, un niveau pour les intervalles de confiance et renvoie une estimation de la variance associ√©e √† l‚Äôestimateur.\nLe variance wrapper est construit √† l‚Äôaide de la fonction define_variance_wrapper en d√©crivant :\n\nla fonction de calcul de la variance (argument variance_function) : il s‚Äôagit d‚Äôune fonction prenant en argument une matrice \\(y\\) d√©crivant la variable d‚Äôint√©r√™t \\(\\{y_k\\}_{k \\in S}\\) ainsi que d‚Äôautres informations permettant de proposer une estimation de la variance d‚Äôun estimateur du total,\nl‚Äôidentifiant des individus (argument reference_id) : il s‚Äôagit d‚Äôun vecteur de m√™me taille que le nombre de lignes de l‚Äôargument \\(\\textbf{y}\\) de la fonction renseign√©e dans l‚Äôargument variance_function indiquant l‚Äôordre des identifiants des individus d√©crits,\nles poids utilis√©s pour l‚Äôestimation (argument reference_weight) : il s‚Äôagit d‚Äôun vecteur num√©rique contenant la pond√©ration des individus. L‚Äôordre des poids dans ce vecteur doit correspondre √† celui des identifiants dans reference_id. Ces poids vont permettre √† gustave de calculer l‚Äôestimation du param√®tre d‚Äôint√©r√™t,\nla liste des donn√©es utilis√©es par la fonction d√©crite dans l‚Äôargument variance_function (argument technical_data) : il s‚Äôagit d‚Äôune liste nomm√©e contenant toutes les donn√©es n√©cessaires au calcul de la variance. Les noms des √©l√©ments de la liste doivent correspondre aux arguments de la fonction d√©crite dans variance_function except√© l‚Äôargument \\(y\\).\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\nUne fois le variance wrapper d√©fini, l‚Äôutilisateur peut calculer des estimations de la variance d‚Äôestimateurs du total selon la m√©thode qu‚Äôil a choisi d‚Äôimpl√©menter (argument variance_function lors de la d√©finition du variance wrapper).\nPar exemple, pour estimer la variance de \\(\\displaystyle \\hat{t}_{y,\\text{cal}} = \\sum_{k \\in S} w_k^\\text{cal} y_k\\), il suffit d‚Äôutiliser la fonction precision_estim cr√©√©e par define_variance_wrapper. Cette fonction contient un argument data correspondant √† la table d√©crivant les informations sur la variable d‚Äôint√©r√™t. L‚Äôutilisateur renseigne ensuite les estimateurs pour lesquels il souhaite une estimation de la variance √† l‚Äôaide d‚Äôune expression. Dans l‚Äôexemple suivant, nous utilisons total(y) pour indiquer que nous souhaitons une estimation du total de la variable y de la table var_interet pond√©r√© par les poids de calage.\n\n\nLa table contenant les variables d‚Äôint√©r√™t (ici var_interet) doit contenir un identifiant dont le nom correspond √† celui de l‚Äôargument default_id de la fonction define_variance_wrapper.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nLes identifiants de la table var_interet ne semblent pas √™tre dans le m√™me ordre que ceux de la table info_ech.\nNous allons r√©aliser une premi√®re tentative en remettant les identifiants dans le m√™me ordre.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nTout se passe bien : aucun message d‚Äôavertissement ou d‚Äôerreur.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nTable des variables d‚Äôint√©r√™t non tri√©e\n\n\n\nSi la variable identifiant de la table var_interet n‚Äôest pas tri√©e dans le m√™me ordre que le vecteur renseign√© dans l‚Äôargument reference_id de define_variance_wrapper, le message d‚Äôavertissement suivant appara√Ætra dans la console :\n The inputted id variable (id argument) appears not to match the reference id variable provided when the variance wrapper was defined: it is reordered and everything should be fine. Issues may nonetheless arise if part of the call is to be evaluated outside of the inputted data.frame (data argument).  \\(\\to\\) gustave remettra en ordre la table.\nPour autant, il est indiqu√© que dans certains cas, des comportements inattendus peuvent appara√Ætre : il est donc recommand√© de v√©rifier l‚Äôordre de la table en intrant du variance wrapper.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\n\n\nTable des variables d‚Äôint√©r√™t avec des observations suppl√©mentaires\n\n\n\nSi la table var_interet contient des individus non renseign√©s dans le param√®tre reference_id de la fonction define_variance_wrapper, ils seront retir√©s et le message d‚Äôavertissement suivant appara√Ætra :\n xxx observations do not match any responding units of the survey. They are discarded \n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\n\n\nTable des variables d‚Äôint√©r√™t avec des observations manquantes\n\n\n\nSi certains individus renseign√©s dans le param√®tre reference_id de la fonction define_variance_wrapper ne sont pas dans la table var_interet alors le message d‚Äôavertissement suivant appara√Ætre : ~\\\n Some observations from the survey appear to be missing. The variance estimation function may produce unexpected results. \n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\nL‚Äôobjectif de cet exercice est de proposer une estimation de :\n\n\\(\\displaystyle \\widehat{\\mathbb{V}}(\\hat{t}_{z,\\text{cal}})\\), un estimateur de la variance de \\(\\displaystyle \\sum_{k \\in S_\\text{US}} z_k w_k^\\text{cal}\\),\n\\(\\displaystyle  \\widehat{\\mathbb{V}}(\\frac{\\hat{t}_{y,\\text{cal}}}{\\hat{t}_{z,\\text{cal}}})\\), un estimateur de la variance de \\(\\displaystyle \\frac{\\sum_{k \\in S_\\text{US}} y_k w_k^\\text{cal}}{\\sum_{k \\in S_\\text{US}} z_k w_k^\\text{cal}}\\).\n\\(\\displaystyle  \\widehat{\\mathbb{V}}(\\log({\\hat{t}_{z,\\text{cal}}}))\\), un estimateur de la variance de \\(\\displaystyle \\log({\\hat{t}_{z,\\text{cal}}})\\).\n\nLes statistic wrapper permettent de calculer l‚Äôestimation de la fonction d‚Äôint√©r√™t √† partir des donn√©es de la table contenant les variables d‚Äôint√©r√™t ainsi que dans la pond√©ration renseign√©e dans l‚Äôargument reference_weight de la fonction variance wrapper. Ces fonctions permettent √©galement de calculer les variables lin√©aris√©es estim√©es. La liste des statistic wrapper pr√©d√©finis dans gustave est disponible ici :\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nIl est possible √† l‚Äôutilisateur d‚Äôen ajouter en utilisant la fonction define_statistic_wrapper.\n\n\nDans ce premier cas, il s‚Äôagit d‚Äôestimer la variance du total d‚Äôun estimateur cal√©. Cette estimation correspond au cas impl√©ment√© directement dans la fonction calcul_var renseign√©e dans l‚Äôargument variance_function de la fonction define_variance_wrapper. Nous n‚Äôavons pas besoin ici de lin√©ariser la fonction d‚Äôint√©r√™t consid√©r√©e (Il est assez imm√©diat de montrer que si la lin√©arisation par d√©veloppement de Taylor √©tait utilis√©e ici alors on retrouverait la variable d‚Äôint√©r√™t comme variable lin√©aris√©e estim√©e).\nDans le cas du total, il n‚Äôest pas n√©cessaire d‚Äôindiquer le statistic wrapper total. Pour autant, pour plus de lisibilit√©, il est recommand√© de toujours indiquer la fonction.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\nPour l‚Äôestimation de la variance de \\(\\frac{\\hat{t}_{y,\\text{cal}}}{\\hat{t}_{z,\\text{cal}}}\\), il est n√©cessaire d‚Äôavoir recours au principe de lin√©arisation. Parmi les statistic wrapper pr√©d√©finis dans gustave, il y a la fonction ratio. Cette derni√®re va √™tre mobilis√©e lors de l‚Äôappel au variance wrapper precision_estim\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\nComme dans le cas pr√©c√©dent, il va √™tre n√©cessaire d‚Äôutiliser le principe de lin√©arisation. N√©anmoins, il n‚Äôexiste pas de statistic wrapper dans gustave correspondant √† la fonction inverse. Nous allons le construire √† l‚Äôaide de la fonction define_statistic_wrapper. Avant cela, il est n√©cessaire de calculer la variable lin√©aris√©e estim√©e.\nLa variable lin√©aris√©e estim√©e est \\(\\widehat{u_k} = \\frac{z_k}{\\hat{t}_{z,\\text{cal}}}\\).\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\nIl est possible de v√©rifier la qualit√© des estimateurs √† l‚Äôaide de simulations. En effet, ici, les variables d‚Äôint√©r√™t sont connues pour tous les individus de la population : nous pouvons donc tirer de nouveaux √©chantillons et appliquer l‚Äôint√©gralit√© des redressements pour avoir de nouvelles r√©alisations des estimateurs cal√©s \\(\\hat{t}_{y,\\text{cal}}\\) et \\(\\hat{t}_{z,\\text{cal}}\\). En pratique, nous ne pouvons utiliser cette m√©thode directement sur les variables d‚Äôint√©r√™t car elles ne sont connues que sur l‚Äô√©chantillon.\n\n\n\n\n\n\nCode pour estimer, par simulation, la variance des estimateurs consid√©r√©s\n\n\n\n\n\nCe code permet d‚Äôobtenir des r√©alisations des estimateurs \\(\\hat{t}_{y,\\text{cal}}\\) et \\(\\hat{t}_{z,\\text{cal}}\\). Un estimateur, bas√© sur \\(N_\\text{sim}\\) simulations, de la variance de \\(f(\\hat{t}_{y,\\text{cal}}, \\hat{t}_{z,\\text{cal}})\\) peut s‚Äôobtenir en calculant la dispersion des \\(N_\\text{sim}\\) r√©alisations de \\(f(\\hat{t}_{y,\\text{cal}}, \\hat{t}_{z,\\text{cal}})\\).\nLe code ci-apr√®s n‚Äôest pas optimal.\n\n#Donn√©es pour colloque\n\n#install.packages(\"icarus\")\n\nlibrary(\"icarus\")\nlibrary(\"data.table\")\n\n\nset.seed(2404)\n\n\nN_psu &lt;- 10000 #\nn_psu &lt;- 1000\nnb_strate_psu &lt;- 5 #number of strates in PSU population\nnom_strate_psu &lt;- LETTERS[1:nb_strate_psu]\nnb_var_cal &lt;- 5\nnb_ssu_per_psu &lt;- 10 #number of ssu in each PSU\nN_ssu &lt;- N_psu * nb_ssu_per_psu #number of ssu in the whole population\nn_ssu_per_psu &lt;- 4 #ssu sample size in each psu\n\n#G√©n√©ration des variables selon une loi normale\nvar_cal &lt;- matrix(rnorm(nb_var_cal*N_ssu), ncol = nb_var_cal)\nvar_cal &lt;- data.table(var_cal)\ncolnames(var_cal) &lt;- paste0(\"var_cal\", 1:nb_var_cal)\n\n#G√©n√©ration des strates\nstrate_psu &lt;- sample(nom_strate_psu, N_psu, replace = TRUE)\n#La table pop_data contient les informations sur l'ensemble de la population.\n#On √©chantillonnera dedans\npop_data &lt;- data.table(\"id_psu\" = paste0(\"psu\", 1:N_psu),\n                       \"strate_psu\" = strate_psu)\nlink_psu_ssu &lt;- data.table(\"id_psu\" = rep(pop_data$id, each = 10),\n                           \"id_ssu\" = paste0(\"ssu\", 1:N_ssu))\n\n\npop_data&lt;- merge(pop_data,\n                 link_psu_ssu,\n                 by = \"id_psu\")\npop_data$id_ssu &lt;- paste0(\"ssu\", 1:N_ssu)\npop_data &lt;- cbind(pop_data, var_cal)\n\n\n#Variable d'int√©r√™t 1/2\npop_data$y &lt;- 100 + as.matrix(var_cal) %*% c(0.2,0.3,0.5,0.1,5) + 30*(pop_data$strate_psu == \"A\") + \n  15*((pop_data$strate_psu %in% c(\"B\",\"C\"))) + 3*(!(pop_data$strate_psu %in% c(\"A\",\"B\",\"C\")))\n#pop_data$z &lt;- 3 + sqrt(pop_data$y) + rnorm(nrow(pop_data), 0, 1)\npop_data$z &lt;- 3 + 2*pop_data$var_cal2 - pop_data$var_cal1*pop_data$var_cal4 + rnorm(nrow(pop_data), 0, 1)\nboxplot(pop_data$y ~ pop_data$strate_psu) #On a bien des comportements diff√©rents selon la strate\nboxplot(pop_data$z ~ pop_data$strate_psu) #On a bien des comportements diff√©rents selon la strate\n\n#Calcul des marges\nmarges &lt;- colSums(pop_data[, paste0(\"var_cal\",1:nb_var_cal), with = F])\n###Mise au format icarus\nmarges_table &lt;- cbind(names(marges), \"0\", marges)\n\n\n###############################\n#####Echantillonnage###########\n###############################\n#SASSR(10%) dans chaque strate de psu\n#SASSR(4) au sein de chaque psu\n\n\nrm(list = setdiff(ls(), c(\"pop_data\",\"n_psu\",\"nb_strate_psu\",\n                          \"n_ssu_per_psu\", \"N_psu\", \"nb_ssu_per_psu\",\n                          \"marges_table\")))\n\n\n\ntirage &lt;- function(pop_data, n_psu, N_psu,  nb_strate_psu, n_ssu_per_psu, nb_ssu_per_psu){\n  #Population of PSU\n  sample_psu &lt;- unique(pop_data[, .(strate_psu, id_psu)])\n  #Tirage selon une loi uniforme\n  sample_psu$tirage_psu &lt;- runif(nrow(sample_psu))\n  #Tri selon les r√©alisations\n  setorder(sample_psu, tirage_psu)\n  #Tirage des psu\n  sample_psu &lt;- sample_psu[,lapply(.SD, function(x){head(unique(x), n = as.integer(n_psu/nb_strate_psu))}), by = strate_psu]\n  sample_psu_id &lt;- sample_psu[, id_psu]\n  \n  #Tirage des ssu\n  sample_ssu &lt;- unique(pop_data[id_psu %in% sample_psu_id, .(id_psu, id_ssu)])\n  sample_ssu$tirage_ssu &lt;- runif(nrow(sample_ssu))\n  setorder(sample_ssu, tirage_ssu)\n  sample_ssu &lt;- sample_ssu[,lapply(.SD, function(x){head(unique(x), n = n_ssu_per_psu)}), by = id_psu]\n  sample_ssu_id &lt;- sample_ssu[, id_ssu]\n  \n  #Ajout d'informations dans la table echantillon\n  echantillon &lt;- pop_data[id_ssu %in% sample_ssu_id]\n  echantillon$pi_psu &lt;- n_psu/N_psu\n  echantillon$pi_ssu_cond_psu &lt;- n_ssu_per_psu/nb_ssu_per_psu\n  echantillon[, poids_avant_calage := 1/(pi_psu*pi_ssu_cond_psu)]\n  echantillon[, eff := 1]\n  \n  #Calage\n  echantillon$poids_apres_calage &lt;- calibration(echantillon,\n                                                marginMatrix = marges_table,\n                                                colWeights = \"poids_avant_calage\",\n                                                description = FALSE)\n  \n  return(echantillon)\n}\n\n\nsimulation &lt;- function(pop_data, \n                       n_psu, \n                       N_psu,\n                       nb_strate_psu, \n                       n_ssu_per_psu,\n                       nb_ssu_per_psu,\n                       nb_sim = 1000L){\n  res &lt;- list()\n  for(i in 1:nb_sim){\n    donnees &lt;- tirage(pop_data, \n                      n_psu, \n                      N_psu,\n                      nb_strate_psu, \n                      n_ssu_per_psu,\n                      nb_ssu_per_psu)\n    res[[i]] &lt;- c(\"v1\" = sum(donnees$z * donnees$poids_apres_calage),\n                  \"v11\" = sum(donnees$z * donnees$poids_avant_calage),\n                  \"v2\" = sum(donnees$y * donnees$poids_apres_calage)/sum(donnees$z * donnees$poids_apres_calage),\n                  \"v21\" = sum(donnees$y * donnees$poids_avant_calage)/sum(donnees$z * donnees$poids_avant_calage),\n                  \"v4\" = log(sum(donnees$z * donnees$poids_apres_calage)),\n                  \"v41\" = log(sum(donnees$z * donnees$poids_avant_calage))\n    )\n    \n  }\n  return(res)\n}\n\n\nres_var &lt;- simulation(pop_data, \n                      n_psu, \n                      N_psu,\n                      nb_strate_psu, \n                      n_ssu_per_psu,\n                      nb_ssu_per_psu,\n                      nb_sim = 10000L)\n\n\nres_sim &lt;- Reduce(rbind, res_var)\nres_sim_mean &lt;- apply(X = res, 2, var)\nres_sim_var &lt;- apply(X = res, 2, var)\n\n\n\n\nLes r√©sultats obtenus apr√®s \\(N_\\text{sim} = 10~000\\) simulations sont :\n\n\n\n\nEstimation de l‚Äôesp√©rance\n\n\n\n\n\nEstimation 1\n\n\nEstimation 2\n\n\nEstimation 3\n\n\n\n\n1\n\n\n2.997E+05\n\n\n3.773E+01\n\n\n1.261E+01\n\n\n\n\n\n\nEstimation de la variance\n\n\n\n\n\nEstimation 1\n\n\nEstimation 2\n\n\nEstimation 3\n\n\n\n\n1\n\n\n4.969E+06\n\n\n7.786E-02\n\n\n5.531E-05\n\n\n\n\n\n\n\n\n\nLe variance wrapper contient toute l‚Äôinformation n√©cessaire au calcul de pr√©cision : cela passe par les donn√©es de calage, les donn√©es utilis√©es pour certains plans de sondage, ‚Ä¶ Ces donn√©es peuvent pr√©senter un enjeu de confidentialit√© en exposant ces donn√©es.\nPrenons l‚Äôexemple d‚Äôun utilisateur ne disposant que du variance wrapper precision_estim.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nLorsqu‚Äôun utilisateur affiche le contenu de la fonction precision_estim, il ne voit pas les donn√©es associ√©es.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nOuf ? Pas de probl√®me donc ‚Ä¶ ? Non, lorsqu‚Äôun utilsateur consid√®re l‚Äôenvironnement associ√© au variance wrapper, il est possible de retrouver les donn√©es.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nOn peut, par exemple, afficher les variables de calage :\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "presentations/var_gustave.html#etape-1-estimateur-de-la-variance-dun-estimateur-cal√©-du-total",
    "href": "presentations/var_gustave.html#etape-1-estimateur-de-la-variance-dun-estimateur-cal√©-du-total",
    "title": "Estimation de variance analytique avec gustave",
    "section": "",
    "text": "Afin d‚Äôestimer la variance d‚Äôune statistique r√©guli√®re, il est n√©cessaire de proposer un estimateur dans le cas simple de l‚Äôestimateur du total. Ce travail, r√©alis√© par le m√©thodologue, consiste √† utiliser des r√©sultats th√©oriques et l‚Äôinformation sur la collecte (plan de sondage, redressements, ‚Ä¶) afin d‚Äôapprocher au mieux un estimateur sans biais de la variance.\nDans certains cas simples (cas d‚Äôun sondage al√©atoire simple sans remise), il n‚Äôest pas n√©cessaire d‚Äôimpl√©menter l‚Äôestimateur : des fonctions pr√™tes √† l‚Äôemploi sont disponibles (fonction qvar par exemple).\nUn estimateur de la variance d‚Äôun estimateur du total d‚ÄôHorvitz-Thompson \\(\\hat{t}_{y,\\text{HT}}\\) sous le plan de l‚Äôexemple est :\n\\[\n    \\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{HT}}) = \\sum_{\\text{st} = 1}^{n_\\text{st}} \\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{HT},\\text{st}})\n\\]\no√π \\[\\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{HT},\\text{st}}) = \\frac{N^2_{\\text{UP}\\cap \\text{st}}}{n_{\\text{UP}\\cap  \\text{st}}} \\left(1-\\underbrace{\\frac{n_{\\text{UP} \\cap \\text{st}}}{N_{\\text{UP}\\cap \\text{st}}}}_{= f_\\text{up}} \\right) s^2_{\\{\\hat{t}_{y,\\text{HT}, u}\\}_{u \\in S_\\text{UP} \\cap \\text{st}}} + \\frac{N_{\\text{UP}\\cap \\text{st}}}{n_{\\text{UP}\\cap \\text{st}}} \\left( \\sum_{u \\in S_\\text{UP} \\cap \\text{st}}  \\frac{N^2_u}{n_u} (1 - \\underbrace{\\frac{n_u}{N_u}}_{=f_u}) s^2_{\\{{y_k}\\}_{k \\in S_\\text{US}   \\cap u}}\\right) \\tag{1}\\]\no√π pour tout \\(u\\in S_\\text{UP}\\), \\(\\displaystyle  \\hat{t}_{y,\\text{HT},u} = \\frac{N_u}{n_u}\\sum_{k \\in S_\\text{US} \\cap u} {y_k}\\) et \\(s^2_{\\{\\hat{t}_{y,\\text{HT}, u}\\}_{u \\in S_\\text{UP}}}\\) (resp. \\(s^2_{\\{y_k}\\}_{k \\in S_\\text{US}   \\cap u}\\)) d√©signe la dispersion de la variable \\(\\{{\\hat{t}_{y,\\text{HT}, u}}\\}_{u \\in S_\\text{UP}}\\) (resp. \\({\\{y_k\\}}_{k \\in S_\\text{US} \\cap u}\\)) sur l‚Äô√©chantillon \\(S_\\text{UP}\\) (resp. \\(S_\\text{US} \\cap u\\)).\n\n\n\n\n\n\nPreuve de l‚Äôexpression de \\(\\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{HT},\\text{st}})\\)\n\n\n\n\n\nIl suffit d‚Äôappliquer la formule de Rao en utilisant l‚Äôestimateur de Sen-Yen-Grundy pour la variance d‚Äôun estimateur du total sous un plan al√©atoire simple sans remise d‚Äôo√π \\(q_u = \\frac{N_{\\text{UP} \\cap \\text{st}}^2}{n_{\\text{UP} \\cap \\text{st}}^2} \\left( 1-f \\right)\\) et \\(\\pi_u^{(1)} = \\frac{n_{\\text{UP}}}{N_{\\text{UP}}}\\).\n\n\n\n\n\n\nUn estimateur de variance d‚Äôun estimateur cal√© peut √™tre calcul√© en utilisant les r√©sultats asymptotiques propos√©s par : un estimateur de la variance de l‚Äôestimateur \\(\\displaystyle \\sum_{k \\in S_\\text{US}} w^\\text{cal}_k y_k\\) dont la pond√©ration est cal√©e sur la variable \\(\\{  \\textbf{x}^\\text{cal}_k\\}_{k \\in S_\\text{US}}\\) est approximativement celle de l‚Äôestimateur d‚ÄôHorvitz-Thompson des r√©sidus \\(\\{\\varepsilon_k\\}_{k \\in S_\\text{US}}\\) de la r√©gression pond√©r√©e (par les poids avant calage) de \\(\\{y_k\\}_{k \\in S_\\text{US}}\\) sur \\(\\{\\textbf{x}_k\\}_{k \\in S_\\text{US}}\\) estim√©e sur \\(S_\\text{US}\\).\nIl en vient que :\n\\[\n\\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{cal}}) \\approx \\widehat{\\mathbb{V}}(\\hat{t}_{\\varepsilon,\\text{HT}})\n\\tag{2}\\]\n\n\n\nEn r√©unissant l‚ÄôEquation¬†1 et l‚ÄôEquation¬†2, il en vient que : \\[\\widehat{\\mathbb{V}}(\\hat{t}_{y,\\text{cal}}) \\approx \\sum_{\\text{st} = 1}^{n_\\text{st}} \\widehat{\\mathbb{V}}(\\hat{t}_{\\varepsilon,\\text{HT},\\text{st}})\\]"
  },
  {
    "objectID": "presentations/var_gustave.html#etape-2-impl√©mentation",
    "href": "presentations/var_gustave.html#etape-2-impl√©mentation",
    "title": "Estimation de variance analytique avec gustave",
    "section": "",
    "text": "La fonction calcul_var correspond √† l‚Äôimpl√©mentation de l‚Äôestimateur construit pr√©c√©demment.\nCet estimateur d√©pend de :\n\nla variable d‚Äôint√©r√™t y,\ndes r√©sidus de la r√©gression de la variable y sur x,\nla fraction de sondage au premier degr√© f_up,\nla fraction de sondage au second degr√© f_us,\nla strate de chaque individu strate\n\nCes √©l√©ments seront donc des arguments de la fonction calcul_var.\n\n\n\nL‚Äôestimateur de variance propos√© n√©cessite le calcul des r√©sidus de la r√©gression de la variable d‚Äôint√©r√™t \\(\\{y_k\\}\\) sur les variables d‚Äôint√©r√™t \\(\\{\\textbf{x}_k\\}\\). Ce calcul n√©cessite donc de conna√Ætre ‚Ä¶ la variable d‚Äôint√©r√™t \\(\\{y_k\\}\\). Pour autant, certaines composantes peuvent √™tre pr√©calcul√©es en amont.\nDans le cas des r√©sidus de la r√©gression de la variable d‚Äôint√©r√™t \\(\\{y_k\\}\\) sur les variables d‚Äôint√©r√™t \\(\\{\\textbf{x}_k\\}\\), il est possible de calculer l‚Äôinverse de la matrice \\(\\displaystyle \\sum_{k \\in S} \\frac{\\textbf{x}_k \\textbf{x}_k^T}{\\pi_k}\\) qui interviendra dans tous les calculs de r√©sidus (et ind√©pendamment de la variable \\(\\{\\textbf{x}_k\\}\\)).\ngustave permet de stocker ces informations dans un format consistant et de r√©utiliser ces informations facilement. Il s‚Äôagit des precalc\nComme vu durant la pr√©sentation, la fonction res_cal permet de r√©cup√©rer les r√©sidus :\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nSi la variable d‚Äôint√©r√™t n‚Äôest pas disponible, il est possible de pr√©calculer certains √©l√©ments entrants dans le calcul des r√©sidus. Dans ce cas, il faudra renseigner NULL √† l‚Äôargument y.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nLe r√©sultat lorsque y est renseign√© est de la m√™me forme que y.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nPar contre, lorsque y = NULL, la fonction renvoie un precalc (formellement, il s‚Äôagit d‚Äôune liste). Cette liste contient les poids de sondage, la matrice des variables auxiliaires et l‚Äôinverse de la matrice de Gram inv.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nprecalc et argument id : permutation\n\n\n\nIl est recommand√© de :\n\nfaire en sorte que y soit toujours une matrice (√† une colonne dans notre cas univari√©),\navoir des lignes nomm√©es pour la matrice y et de renseigner l‚Äôargument id afin que gustave puisse v√©rifier au moment de l‚Äôapplication de la fonction res_cal si les valeurs renseign√©es dans le precalc et dans l‚Äôargument y sont dans le m√™me ordre.\n\nSi ce n‚Äôest pas le cas, gustave renvoie une erreur.\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\n\n\nprecalc et absence d‚Äôargument id\n\n\n\nSi les lignes de la variable y ne sont pas nomm√©es ou si l‚Äôargument id n‚Äôa pas √©t√© compl√©t√© au moment de la d√©finition du precalc alors aucune v√©rification ne pourra √™tre r√©alis√©e.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\nL‚Äôimpl√©mentation de l‚Äôestimateur peut-√™tre d√©compos√©e en plusieurs √©tapes :\n\ncalcul des r√©sidus √† l‚Äôaide de la fonction gustave::res_cal,\ncalcul des estimations des totaux dans chaque unit√© primaire √† l‚Äôaide de la fonction gustave::sum_by et de la fraction de sondage f_us\ncalcul de la variance de premier degr√© en utilisant la\ncalcul de la variance du second degr√©.\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nConseil pour l‚Äôimpl√©mentation de la fonction calculant la variance\n\n\n\nIl est recommand√© de construire la fonction calcul_var en faisant comme si y √©tait une matrice (√©ventuellement √† une colonne) : cela permettra de pouvoir estimer la variance de plusieurs fonctions d‚Äôint√©r√™t plus rapidement.\n\n\n\n\n\nL‚Äôimpl√©mentation de l‚Äôestimateur passe par la d√©finition d‚Äôun variance wrapper. Le variance wrapper contient toutes les informations n√©cessaires pour l‚Äôestimation. Il prend en argument une table contenant les variables d‚Äôint√©r√™t ainsi qu‚Äôune expression d√©crivant un estimateur, un niveau pour les intervalles de confiance et renvoie une estimation de la variance associ√©e √† l‚Äôestimateur.\nLe variance wrapper est construit √† l‚Äôaide de la fonction define_variance_wrapper en d√©crivant :\n\nla fonction de calcul de la variance (argument variance_function) : il s‚Äôagit d‚Äôune fonction prenant en argument une matrice \\(y\\) d√©crivant la variable d‚Äôint√©r√™t \\(\\{y_k\\}_{k \\in S}\\) ainsi que d‚Äôautres informations permettant de proposer une estimation de la variance d‚Äôun estimateur du total,\nl‚Äôidentifiant des individus (argument reference_id) : il s‚Äôagit d‚Äôun vecteur de m√™me taille que le nombre de lignes de l‚Äôargument \\(\\textbf{y}\\) de la fonction renseign√©e dans l‚Äôargument variance_function indiquant l‚Äôordre des identifiants des individus d√©crits,\nles poids utilis√©s pour l‚Äôestimation (argument reference_weight) : il s‚Äôagit d‚Äôun vecteur num√©rique contenant la pond√©ration des individus. L‚Äôordre des poids dans ce vecteur doit correspondre √† celui des identifiants dans reference_id. Ces poids vont permettre √† gustave de calculer l‚Äôestimation du param√®tre d‚Äôint√©r√™t,\nla liste des donn√©es utilis√©es par la fonction d√©crite dans l‚Äôargument variance_function (argument technical_data) : il s‚Äôagit d‚Äôune liste nomm√©e contenant toutes les donn√©es n√©cessaires au calcul de la variance. Les noms des √©l√©ments de la liste doivent correspondre aux arguments de la fonction d√©crite dans variance_function except√© l‚Äôargument \\(y\\).\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "presentations/var_gustave.html#etape-3-utilisation-et-diffusion",
    "href": "presentations/var_gustave.html#etape-3-utilisation-et-diffusion",
    "title": "Estimation de variance analytique avec gustave",
    "section": "",
    "text": "Une fois le variance wrapper d√©fini, l‚Äôutilisateur peut calculer des estimations de la variance d‚Äôestimateurs du total selon la m√©thode qu‚Äôil a choisi d‚Äôimpl√©menter (argument variance_function lors de la d√©finition du variance wrapper).\nPar exemple, pour estimer la variance de \\(\\displaystyle \\hat{t}_{y,\\text{cal}} = \\sum_{k \\in S} w_k^\\text{cal} y_k\\), il suffit d‚Äôutiliser la fonction precision_estim cr√©√©e par define_variance_wrapper. Cette fonction contient un argument data correspondant √† la table d√©crivant les informations sur la variable d‚Äôint√©r√™t. L‚Äôutilisateur renseigne ensuite les estimateurs pour lesquels il souhaite une estimation de la variance √† l‚Äôaide d‚Äôune expression. Dans l‚Äôexemple suivant, nous utilisons total(y) pour indiquer que nous souhaitons une estimation du total de la variable y de la table var_interet pond√©r√© par les poids de calage.\n\n\nLa table contenant les variables d‚Äôint√©r√™t (ici var_interet) doit contenir un identifiant dont le nom correspond √† celui de l‚Äôargument default_id de la fonction define_variance_wrapper.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nLes identifiants de la table var_interet ne semblent pas √™tre dans le m√™me ordre que ceux de la table info_ech.\nNous allons r√©aliser une premi√®re tentative en remettant les identifiants dans le m√™me ordre.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nTout se passe bien : aucun message d‚Äôavertissement ou d‚Äôerreur.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nTable des variables d‚Äôint√©r√™t non tri√©e\n\n\n\nSi la variable identifiant de la table var_interet n‚Äôest pas tri√©e dans le m√™me ordre que le vecteur renseign√© dans l‚Äôargument reference_id de define_variance_wrapper, le message d‚Äôavertissement suivant appara√Ætra dans la console :\n The inputted id variable (id argument) appears not to match the reference id variable provided when the variance wrapper was defined: it is reordered and everything should be fine. Issues may nonetheless arise if part of the call is to be evaluated outside of the inputted data.frame (data argument).  \\(\\to\\) gustave remettra en ordre la table.\nPour autant, il est indiqu√© que dans certains cas, des comportements inattendus peuvent appara√Ætre : il est donc recommand√© de v√©rifier l‚Äôordre de la table en intrant du variance wrapper.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\n\n\nTable des variables d‚Äôint√©r√™t avec des observations suppl√©mentaires\n\n\n\nSi la table var_interet contient des individus non renseign√©s dans le param√®tre reference_id de la fonction define_variance_wrapper, ils seront retir√©s et le message d‚Äôavertissement suivant appara√Ætra :\n xxx observations do not match any responding units of the survey. They are discarded \n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\n\n\nTable des variables d‚Äôint√©r√™t avec des observations manquantes\n\n\n\nSi certains individus renseign√©s dans le param√®tre reference_id de la fonction define_variance_wrapper ne sont pas dans la table var_interet alors le message d‚Äôavertissement suivant appara√Ætre : ~\\\n Some observations from the survey appear to be missing. The variance estimation function may produce unexpected results. \n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\nL‚Äôobjectif de cet exercice est de proposer une estimation de :\n\n\\(\\displaystyle \\widehat{\\mathbb{V}}(\\hat{t}_{z,\\text{cal}})\\), un estimateur de la variance de \\(\\displaystyle \\sum_{k \\in S_\\text{US}} z_k w_k^\\text{cal}\\),\n\\(\\displaystyle  \\widehat{\\mathbb{V}}(\\frac{\\hat{t}_{y,\\text{cal}}}{\\hat{t}_{z,\\text{cal}}})\\), un estimateur de la variance de \\(\\displaystyle \\frac{\\sum_{k \\in S_\\text{US}} y_k w_k^\\text{cal}}{\\sum_{k \\in S_\\text{US}} z_k w_k^\\text{cal}}\\).\n\\(\\displaystyle  \\widehat{\\mathbb{V}}(\\log({\\hat{t}_{z,\\text{cal}}}))\\), un estimateur de la variance de \\(\\displaystyle \\log({\\hat{t}_{z,\\text{cal}}})\\).\n\nLes statistic wrapper permettent de calculer l‚Äôestimation de la fonction d‚Äôint√©r√™t √† partir des donn√©es de la table contenant les variables d‚Äôint√©r√™t ainsi que dans la pond√©ration renseign√©e dans l‚Äôargument reference_weight de la fonction variance wrapper. Ces fonctions permettent √©galement de calculer les variables lin√©aris√©es estim√©es. La liste des statistic wrapper pr√©d√©finis dans gustave est disponible ici :\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nIl est possible √† l‚Äôutilisateur d‚Äôen ajouter en utilisant la fonction define_statistic_wrapper.\n\n\nDans ce premier cas, il s‚Äôagit d‚Äôestimer la variance du total d‚Äôun estimateur cal√©. Cette estimation correspond au cas impl√©ment√© directement dans la fonction calcul_var renseign√©e dans l‚Äôargument variance_function de la fonction define_variance_wrapper. Nous n‚Äôavons pas besoin ici de lin√©ariser la fonction d‚Äôint√©r√™t consid√©r√©e (Il est assez imm√©diat de montrer que si la lin√©arisation par d√©veloppement de Taylor √©tait utilis√©e ici alors on retrouverait la variable d‚Äôint√©r√™t comme variable lin√©aris√©e estim√©e).\nDans le cas du total, il n‚Äôest pas n√©cessaire d‚Äôindiquer le statistic wrapper total. Pour autant, pour plus de lisibilit√©, il est recommand√© de toujours indiquer la fonction.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\nPour l‚Äôestimation de la variance de \\(\\frac{\\hat{t}_{y,\\text{cal}}}{\\hat{t}_{z,\\text{cal}}}\\), il est n√©cessaire d‚Äôavoir recours au principe de lin√©arisation. Parmi les statistic wrapper pr√©d√©finis dans gustave, il y a la fonction ratio. Cette derni√®re va √™tre mobilis√©e lors de l‚Äôappel au variance wrapper precision_estim\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\nComme dans le cas pr√©c√©dent, il va √™tre n√©cessaire d‚Äôutiliser le principe de lin√©arisation. N√©anmoins, il n‚Äôexiste pas de statistic wrapper dans gustave correspondant √† la fonction inverse. Nous allons le construire √† l‚Äôaide de la fonction define_statistic_wrapper. Avant cela, il est n√©cessaire de calculer la variable lin√©aris√©e estim√©e.\nLa variable lin√©aris√©e estim√©e est \\(\\widehat{u_k} = \\frac{z_k}{\\hat{t}_{z,\\text{cal}}}\\).\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\nIl est possible de v√©rifier la qualit√© des estimateurs √† l‚Äôaide de simulations. En effet, ici, les variables d‚Äôint√©r√™t sont connues pour tous les individus de la population : nous pouvons donc tirer de nouveaux √©chantillons et appliquer l‚Äôint√©gralit√© des redressements pour avoir de nouvelles r√©alisations des estimateurs cal√©s \\(\\hat{t}_{y,\\text{cal}}\\) et \\(\\hat{t}_{z,\\text{cal}}\\). En pratique, nous ne pouvons utiliser cette m√©thode directement sur les variables d‚Äôint√©r√™t car elles ne sont connues que sur l‚Äô√©chantillon.\n\n\n\n\n\n\nCode pour estimer, par simulation, la variance des estimateurs consid√©r√©s\n\n\n\n\n\nCe code permet d‚Äôobtenir des r√©alisations des estimateurs \\(\\hat{t}_{y,\\text{cal}}\\) et \\(\\hat{t}_{z,\\text{cal}}\\). Un estimateur, bas√© sur \\(N_\\text{sim}\\) simulations, de la variance de \\(f(\\hat{t}_{y,\\text{cal}}, \\hat{t}_{z,\\text{cal}})\\) peut s‚Äôobtenir en calculant la dispersion des \\(N_\\text{sim}\\) r√©alisations de \\(f(\\hat{t}_{y,\\text{cal}}, \\hat{t}_{z,\\text{cal}})\\).\nLe code ci-apr√®s n‚Äôest pas optimal.\n\n#Donn√©es pour colloque\n\n#install.packages(\"icarus\")\n\nlibrary(\"icarus\")\nlibrary(\"data.table\")\n\n\nset.seed(2404)\n\n\nN_psu &lt;- 10000 #\nn_psu &lt;- 1000\nnb_strate_psu &lt;- 5 #number of strates in PSU population\nnom_strate_psu &lt;- LETTERS[1:nb_strate_psu]\nnb_var_cal &lt;- 5\nnb_ssu_per_psu &lt;- 10 #number of ssu in each PSU\nN_ssu &lt;- N_psu * nb_ssu_per_psu #number of ssu in the whole population\nn_ssu_per_psu &lt;- 4 #ssu sample size in each psu\n\n#G√©n√©ration des variables selon une loi normale\nvar_cal &lt;- matrix(rnorm(nb_var_cal*N_ssu), ncol = nb_var_cal)\nvar_cal &lt;- data.table(var_cal)\ncolnames(var_cal) &lt;- paste0(\"var_cal\", 1:nb_var_cal)\n\n#G√©n√©ration des strates\nstrate_psu &lt;- sample(nom_strate_psu, N_psu, replace = TRUE)\n#La table pop_data contient les informations sur l'ensemble de la population.\n#On √©chantillonnera dedans\npop_data &lt;- data.table(\"id_psu\" = paste0(\"psu\", 1:N_psu),\n                       \"strate_psu\" = strate_psu)\nlink_psu_ssu &lt;- data.table(\"id_psu\" = rep(pop_data$id, each = 10),\n                           \"id_ssu\" = paste0(\"ssu\", 1:N_ssu))\n\n\npop_data&lt;- merge(pop_data,\n                 link_psu_ssu,\n                 by = \"id_psu\")\npop_data$id_ssu &lt;- paste0(\"ssu\", 1:N_ssu)\npop_data &lt;- cbind(pop_data, var_cal)\n\n\n#Variable d'int√©r√™t 1/2\npop_data$y &lt;- 100 + as.matrix(var_cal) %*% c(0.2,0.3,0.5,0.1,5) + 30*(pop_data$strate_psu == \"A\") + \n  15*((pop_data$strate_psu %in% c(\"B\",\"C\"))) + 3*(!(pop_data$strate_psu %in% c(\"A\",\"B\",\"C\")))\n#pop_data$z &lt;- 3 + sqrt(pop_data$y) + rnorm(nrow(pop_data), 0, 1)\npop_data$z &lt;- 3 + 2*pop_data$var_cal2 - pop_data$var_cal1*pop_data$var_cal4 + rnorm(nrow(pop_data), 0, 1)\nboxplot(pop_data$y ~ pop_data$strate_psu) #On a bien des comportements diff√©rents selon la strate\nboxplot(pop_data$z ~ pop_data$strate_psu) #On a bien des comportements diff√©rents selon la strate\n\n#Calcul des marges\nmarges &lt;- colSums(pop_data[, paste0(\"var_cal\",1:nb_var_cal), with = F])\n###Mise au format icarus\nmarges_table &lt;- cbind(names(marges), \"0\", marges)\n\n\n###############################\n#####Echantillonnage###########\n###############################\n#SASSR(10%) dans chaque strate de psu\n#SASSR(4) au sein de chaque psu\n\n\nrm(list = setdiff(ls(), c(\"pop_data\",\"n_psu\",\"nb_strate_psu\",\n                          \"n_ssu_per_psu\", \"N_psu\", \"nb_ssu_per_psu\",\n                          \"marges_table\")))\n\n\n\ntirage &lt;- function(pop_data, n_psu, N_psu,  nb_strate_psu, n_ssu_per_psu, nb_ssu_per_psu){\n  #Population of PSU\n  sample_psu &lt;- unique(pop_data[, .(strate_psu, id_psu)])\n  #Tirage selon une loi uniforme\n  sample_psu$tirage_psu &lt;- runif(nrow(sample_psu))\n  #Tri selon les r√©alisations\n  setorder(sample_psu, tirage_psu)\n  #Tirage des psu\n  sample_psu &lt;- sample_psu[,lapply(.SD, function(x){head(unique(x), n = as.integer(n_psu/nb_strate_psu))}), by = strate_psu]\n  sample_psu_id &lt;- sample_psu[, id_psu]\n  \n  #Tirage des ssu\n  sample_ssu &lt;- unique(pop_data[id_psu %in% sample_psu_id, .(id_psu, id_ssu)])\n  sample_ssu$tirage_ssu &lt;- runif(nrow(sample_ssu))\n  setorder(sample_ssu, tirage_ssu)\n  sample_ssu &lt;- sample_ssu[,lapply(.SD, function(x){head(unique(x), n = n_ssu_per_psu)}), by = id_psu]\n  sample_ssu_id &lt;- sample_ssu[, id_ssu]\n  \n  #Ajout d'informations dans la table echantillon\n  echantillon &lt;- pop_data[id_ssu %in% sample_ssu_id]\n  echantillon$pi_psu &lt;- n_psu/N_psu\n  echantillon$pi_ssu_cond_psu &lt;- n_ssu_per_psu/nb_ssu_per_psu\n  echantillon[, poids_avant_calage := 1/(pi_psu*pi_ssu_cond_psu)]\n  echantillon[, eff := 1]\n  \n  #Calage\n  echantillon$poids_apres_calage &lt;- calibration(echantillon,\n                                                marginMatrix = marges_table,\n                                                colWeights = \"poids_avant_calage\",\n                                                description = FALSE)\n  \n  return(echantillon)\n}\n\n\nsimulation &lt;- function(pop_data, \n                       n_psu, \n                       N_psu,\n                       nb_strate_psu, \n                       n_ssu_per_psu,\n                       nb_ssu_per_psu,\n                       nb_sim = 1000L){\n  res &lt;- list()\n  for(i in 1:nb_sim){\n    donnees &lt;- tirage(pop_data, \n                      n_psu, \n                      N_psu,\n                      nb_strate_psu, \n                      n_ssu_per_psu,\n                      nb_ssu_per_psu)\n    res[[i]] &lt;- c(\"v1\" = sum(donnees$z * donnees$poids_apres_calage),\n                  \"v11\" = sum(donnees$z * donnees$poids_avant_calage),\n                  \"v2\" = sum(donnees$y * donnees$poids_apres_calage)/sum(donnees$z * donnees$poids_apres_calage),\n                  \"v21\" = sum(donnees$y * donnees$poids_avant_calage)/sum(donnees$z * donnees$poids_avant_calage),\n                  \"v4\" = log(sum(donnees$z * donnees$poids_apres_calage)),\n                  \"v41\" = log(sum(donnees$z * donnees$poids_avant_calage))\n    )\n    \n  }\n  return(res)\n}\n\n\nres_var &lt;- simulation(pop_data, \n                      n_psu, \n                      N_psu,\n                      nb_strate_psu, \n                      n_ssu_per_psu,\n                      nb_ssu_per_psu,\n                      nb_sim = 10000L)\n\n\nres_sim &lt;- Reduce(rbind, res_var)\nres_sim_mean &lt;- apply(X = res, 2, var)\nres_sim_var &lt;- apply(X = res, 2, var)\n\n\n\n\nLes r√©sultats obtenus apr√®s \\(N_\\text{sim} = 10~000\\) simulations sont :\n\n\n\n\nEstimation de l‚Äôesp√©rance\n\n\n\n\n\nEstimation 1\n\n\nEstimation 2\n\n\nEstimation 3\n\n\n\n\n1\n\n\n2.997E+05\n\n\n3.773E+01\n\n\n1.261E+01\n\n\n\n\n\n\nEstimation de la variance\n\n\n\n\n\nEstimation 1\n\n\nEstimation 2\n\n\nEstimation 3\n\n\n\n\n1\n\n\n4.969E+06\n\n\n7.786E-02\n\n\n5.531E-05"
  },
  {
    "objectID": "presentations/var_gustave.html#variance-wrapper-et-confidentialit√©",
    "href": "presentations/var_gustave.html#variance-wrapper-et-confidentialit√©",
    "title": "Estimation de variance analytique avec gustave",
    "section": "",
    "text": "Le variance wrapper contient toute l‚Äôinformation n√©cessaire au calcul de pr√©cision : cela passe par les donn√©es de calage, les donn√©es utilis√©es pour certains plans de sondage, ‚Ä¶ Ces donn√©es peuvent pr√©senter un enjeu de confidentialit√© en exposant ces donn√©es.\nPrenons l‚Äôexemple d‚Äôun utilisateur ne disposant que du variance wrapper precision_estim.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nLorsqu‚Äôun utilisateur affiche le contenu de la fonction precision_estim, il ne voit pas les donn√©es associ√©es.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nOuf ? Pas de probl√®me donc ‚Ä¶ ? Non, lorsqu‚Äôun utilsateur consid√®re l‚Äôenvironnement associ√© au variance wrapper, il est possible de retrouver les donn√©es.\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nOn peut, par exemple, afficher les variables de calage :\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  }
]